<!DOCTYPE html>
<html lang="en"  >

<head>
    <meta charset="utf-8" />

    
    <title> Travel Request | PI-Smart</title>

    
    <meta name="description" content="" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <meta name="csrf-token" content="5azwwl4SfkOCTscqld4kN4YzbtwxmZFSI6Rqh5zu">

    
    <link rel="shortcut icon" href="https://pismart.pupuk-indonesia.com/public/media/logos/favicon.ico" />

    <link href="https://pismart.pupuk-indonesia.com/public/assets/css/pages/wizard/wizard-1.css" rel="stylesheet" type="text/css" />

    
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Poppins:300,400,500,600,700">

    
        <link href="https://pismart.pupuk-indonesia.com/public/plugins/global/plugins.bundle.css" rel="stylesheet" type="text/css" />
        <link href="https://pismart.pupuk-indonesia.com/public/plugins/custom/prismjs/prismjs.bundle.css" rel="stylesheet" type="text/css" />
        <link href="https://pismart.pupuk-indonesia.com/public/css/style.bundle.css" rel="stylesheet" type="text/css" />
    
    
        <link href="https://pismart.pupuk-indonesia.com/public/css/themes/layout/header/base/light.css" rel="stylesheet" type="text/css" />
        <link href="https://pismart.pupuk-indonesia.com/public/css/themes/layout/header/menu/light.css" rel="stylesheet" type="text/css" />
        <link href="https://pismart.pupuk-indonesia.com/public/css/themes/layout/aside/dark.css" rel="stylesheet" type="text/css" />
        <link href="https://pismart.pupuk-indonesia.com/public/css/themes/layout/brand/dark.css" rel="stylesheet" type="text/css" />
    
    
    <link href="https://pismart.pupuk-indonesia.com/public/assets/css/pages/wizard/wizard-4.css" rel="stylesheet" type="text/css" />
<style>
    .dt-body-nowarp {
        white-space: nowrap;
    }

    .dropzone .dz-preview .dz-image {
        width: 200px;
        height: 200px;
    }

    .dz-image img {
        width: 200px !important;
        height: 200px !important;
    }
</style>

    <script>
    function imgError(image) {
        image.onerror = "";
        image.src = "https://pismart.pupuk-indonesia.com/public/assets/media/users/default.jpg";
        return true;
    }
</script>
    <style>
        /* Chrome, Safari, Edge, Opera */
        input::-webkit-outer-spin-button,
        input::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }

        /* Firefox */
        input[type=number] {
            -moz-appearance: textfield;
        }
    </style>
</head>

<body  id="kt_body"   class="page-loading-enabled page-loading quick-panel-right demo-panel-right offcanvas-right header-fixed header-mobile-fixed subheader-enabled subheader-fixed aside-enabled aside-minimize-hoverable aside-fixed page-loading"  id="body-web">
    <input type="hidden" name="token_oauth" id="token_oauth" value="eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJhdWQiOiIxMjQ4IiwianRpIjoiM2QxNTY2ZGM5NzM0NzcwYmIzNzJkZmUxNTI2M2IwNzE1ZmQ5NWU1YmI0OGM0YWYxMzEwMzA0ZWFjMDc2MzM0YjRkY2NjNmQxZGFlMzI2YzgiLCJpYXQiOjE3MDYxNDc5MTIuNjYwOTA4LCJuYmYiOjE3MDYxNDc5MTIuNjYwOTExLCJleHAiOjE3Mzc3NzAzMTIuNjE2MTUxLCJzdWIiOiIxMDg4Iiwic2NvcGVzIjpbXX0.pqA6RKgDx6YDOAbbiUS1XkqYLW4rc4E-vpyqXyGQ9r6-1T61WJorGXh7l6cwCgisfUyGhcU5QJwWyVT2cX70Zhelil9uxTA-IhFJELykwE7PPUIZYxov5sIGMvqsbtikNOxfYbkogmKHxqSQyTdGqW2G53ZRgaPBrSLLiOM1IAKty8IYQdo-Xs3vOyrL_mArsPnMoVHcytbhk_i-VjMKcaWYLhq_A09Av1SZrwX4SN7Wy2c5jI1SFaAp5SmkJN7rR8YNRYCJfXq6s5g5O0WFwMrnY0cl8oSbY8_QXBPfUHCdB1NXl1yf1foPKxNPS9KoUm0r68MeGsafbNTFf66CT2KLxvhebBHeyJKYr6XqV_Fq9MW3oHtXEj17yx4shl0rFs0PitLKIHEURJlJCtS1bLERBGabd3yPV3NoP-FalcUdNDPJ18h0b5Z9tA79-pqsxQzf3P-MZhR3NUpspRdmnofErMTGlMM_HClIRXBSMBeHGtqit9EjPGrW93skUX70rpyaWCvrJ4W9nRfy1IqWHB0j7RJkPN8h93Twd9KnByBJFQPTqg8lYcJUM29zX2zwL_6dR-Hp6y7JtLf0GrW0XdrBn-Mtbw-D8wIDvQnla-dzoTNsUk1hq_a0Z7kZNT4S6Zhh5SpGDHcApf2hEN7tZ8vawQRAJDGJvPaWgSj6zw0">

        <div class="page-loader">
        <div class="spinner spinner-primary"></div>
    </div>




    
    <div id="kt_header_mobile" class="header-mobile header-mobile-travel-dinas  header-mobile-fixed " >
    <div class="mobile-logo">
        <a href="https://pismart.pupuk-indonesia.com">

            
            
                                                    
            
            
        </a>
    </div>
    <div class="d-flex align-items-center">

                    <button class="btn p-0 burger-icon burger-icon-left" id="kt_aside_mobile_toggle"><span></span></button>
        
        
        <button class="btn btn-hover-text-primary p-0 ml-2" id="kt_header_mobile_topbar_toggle">
            <span class="svg-icon svg-icon-xl"><!--begin::Svg Icon | path:public/media/svg/icons/General/User.svg--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24px" height="24px" viewBox="0 0 24 24" version="1.1">
    <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
        <polygon points="0 0 24 0 24 24 0 24"/>
        <path d="M12,11 C9.790861,11 8,9.209139 8,7 C8,4.790861 9.790861,3 12,3 C14.209139,3 16,4.790861 16,7 C16,9.209139 14.209139,11 12,11 Z" fill="#000000" fill-rule="nonzero" opacity="0.3"/>
        <path d="M3.00065168,20.1992055 C3.38825852,15.4265159 7.26191235,13 11.9833413,13 C16.7712164,13 20.7048837,15.2931929 20.9979143,20.2 C21.0095879,20.3954741 20.9979143,21 20.2466999,21 C16.541124,21 11.0347247,21 3.72750223,21 C3.47671215,21 2.97953825,20.45918 3.00065168,20.1992055 Z" fill="#000000" fill-rule="nonzero"/>
    </g>
</svg><!--end::Svg Icon--></span>
        </button>

    </div>
</div>

    <div class="d-flex flex-column flex-root">
        <div class="d-flex flex-row flex-column-fluid page">

                            <div class="aside aside-travel-dinas aside-left  aside-fixed  d-flex flex-column flex-row-auto" id="kt_aside">

    
    <div class="brand brand-travel-dinas flex-column-auto " id="kt_brand">
        <div class="brand-logo">
            <a href="https://pismart.pupuk-indonesia.com">
                <img alt="PI-Smart" height="20" width="100" src="https://pismart.pupuk-indonesia.com/public/media/logos/logo-pismart-light.png"/>
            </a>
        </div>

                    <button class="brand-toggle btn btn-sm px-0" id="kt_aside_toggle">
                <span class="svg-icon svg-icon-xl"><!--begin::Svg Icon | path:public/media/svg/icons/Navigation/Angle-double-left.svg--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24px" height="24px" viewBox="0 0 24 24" version="1.1">
    <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
        <polygon points="0 0 24 0 24 24 0 24"/>
        <path d="M5.29288961,6.70710318 C4.90236532,6.31657888 4.90236532,5.68341391 5.29288961,5.29288961 C5.68341391,4.90236532 6.31657888,4.90236532 6.70710318,5.29288961 L12.7071032,11.2928896 C13.0856821,11.6714686 13.0989277,12.281055 12.7371505,12.675721 L7.23715054,18.675721 C6.86395813,19.08284 6.23139076,19.1103429 5.82427177,18.7371505 C5.41715278,18.3639581 5.38964985,17.7313908 5.76284226,17.3242718 L10.6158586,12.0300721 L5.29288961,6.70710318 Z" fill="#000000" fill-rule="nonzero" transform="translate(8.999997, 11.999999) scale(-1, 1) translate(-8.999997, -11.999999) "/>
        <path d="M10.7071009,15.7071068 C10.3165766,16.0976311 9.68341162,16.0976311 9.29288733,15.7071068 C8.90236304,15.3165825 8.90236304,14.6834175 9.29288733,14.2928932 L15.2928873,8.29289322 C15.6714663,7.91431428 16.2810527,7.90106866 16.6757187,8.26284586 L22.6757187,13.7628459 C23.0828377,14.1360383 23.1103407,14.7686056 22.7371482,15.1757246 C22.3639558,15.5828436 21.7313885,15.6103465 21.3242695,15.2371541 L16.0300699,10.3841378 L10.7071009,15.7071068 Z" fill="#000000" fill-rule="nonzero" opacity="0.3" transform="translate(15.999997, 11.999999) scale(-1, 1) rotate(-270.000000) translate(-15.999997, -11.999999) "/>
    </g>
</svg><!--end::Svg Icon--></span>
            </button>
        
    </div>

    
    <div class="aside-menu-wrapper flex-column-fluid" id="kt_aside_menu_wrapper">

        
        <div
            id="kt_aside_menu"
            class="aside-menu svg-icon-light aside-menu-travel-dinas my-4 "
            data-menu-vertical="1"
             data-menu-scroll="1" data-menu-dropdown-timeout="500" >

            <ul class="menu-nav ">
                <li class="menu-section menu-section--first">
                <h4 class="menu-text">DASHBOARD</h4>
                <i class="menu-icon flaticon-more-v2"></i>
            </li><li class="menu-item " aria-haspopup="true" ><a  href="https://pismart.pupuk-indonesia.com/travel_management/dashboard" class="menu-link "><span class="svg-icon menu-icon "><!--begin::Svg Icon | path:public//media/svg/icons/Text/Menu.svg--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24px" height="24px" viewBox="0 0 24 24" version="1.1">
    <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
        <rect x="0" y="0" width="24" height="24"/>
        <rect fill="#000000" x="4" y="5" width="16" height="3" rx="1.5"/>
        <path d="M5.5,15 L18.5,15 C19.3284271,15 20,15.6715729 20,16.5 C20,17.3284271 19.3284271,18 18.5,18 L5.5,18 C4.67157288,18 4,17.3284271 4,16.5 C4,15.6715729 4.67157288,15 5.5,15 Z M5.5,10 L18.5,10 C19.3284271,10 20,10.6715729 20,11.5 C20,12.3284271 19.3284271,13 18.5,13 L5.5,13 C4.67157288,13 4,12.3284271 4,11.5 C4,10.6715729 4.67157288,10 5.5,10 Z" fill="#000000" opacity="0.3"/>
    </g>
</svg><!--end::Svg Icon--></span><span class="menu-text">Dashboard</span></a></li><li class="menu-section ">
                <h4 class="menu-text">TRAVEL MANAGEMENT MENU</h4>
                <i class="menu-icon flaticon-more-v2"></i>
            </li><li class="menu-item " aria-haspopup="true" ><a  href="https://pismart.pupuk-indonesia.com/travel_management/travel_request" class="menu-link "><span class="svg-icon menu-icon "><!--begin::Svg Icon | path:public//media/svg/icons/Files/Selected-file.svg--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24px" height="24px" viewBox="0 0 24 24" version="1.1">
    <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
        <polygon points="0 0 24 0 24 24 0 24"/>
        <path d="M4.85714286,1 L11.7364114,1 C12.0910962,1 12.4343066,1.12568431 12.7051108,1.35473959 L17.4686994,5.3839416 C17.8056532,5.66894833 18,6.08787823 18,6.52920201 L18,19.0833333 C18,20.8738751 17.9795521,21 16.1428571,21 L4.85714286,21 C3.02044787,21 3,20.8738751 3,19.0833333 L3,2.91666667 C3,1.12612489 3.02044787,1 4.85714286,1 Z M8,12 C7.44771525,12 7,12.4477153 7,13 C7,13.5522847 7.44771525,14 8,14 L15,14 C15.5522847,14 16,13.5522847 16,13 C16,12.4477153 15.5522847,12 15,12 L8,12 Z M8,16 C7.44771525,16 7,16.4477153 7,17 C7,17.5522847 7.44771525,18 8,18 L11,18 C11.5522847,18 12,17.5522847 12,17 C12,16.4477153 11.5522847,16 11,16 L8,16 Z" fill="#000000" fill-rule="nonzero" opacity="0.3"/>
        <path d="M6.85714286,3 L14.7364114,3 C15.0910962,3 15.4343066,3.12568431 15.7051108,3.35473959 L20.4686994,7.3839416 C20.8056532,7.66894833 21,8.08787823 21,8.52920201 L21,21.0833333 C21,22.8738751 20.9795521,23 19.1428571,23 L6.85714286,23 C5.02044787,23 5,22.8738751 5,21.0833333 L5,4.91666667 C5,3.12612489 5.02044787,3 6.85714286,3 Z M8,12 C7.44771525,12 7,12.4477153 7,13 C7,13.5522847 7.44771525,14 8,14 L15,14 C15.5522847,14 16,13.5522847 16,13 C16,12.4477153 15.5522847,12 15,12 L8,12 Z M8,16 C7.44771525,16 7,16.4477153 7,17 C7,17.5522847 7.44771525,18 8,18 L11,18 C11.5522847,18 12,17.5522847 12,17 C12,16.4477153 11.5522847,16 11,16 L8,16 Z" fill="#000000" fill-rule="nonzero"/>
    </g>
</svg><!--end::Svg Icon--></span><span class="menu-text">Travel Request</span></a></li><li class="menu-item " aria-haspopup="true" ><a  href="https://pismart.pupuk-indonesia.com/travel_management/travel_expense" class="menu-link "><span class="svg-icon menu-icon "><!--begin::Svg Icon | path:public//media/svg/icons/Shopping/Money.svg--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24px" height="24px" viewBox="0 0 24 24" version="1.1">
    <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
        <rect x="0" y="0" width="24" height="24"/>
        <path d="M2,6 L21,6 C21.5522847,6 22,6.44771525 22,7 L22,17 C22,17.5522847 21.5522847,18 21,18 L2,18 C1.44771525,18 1,17.5522847 1,17 L1,7 C1,6.44771525 1.44771525,6 2,6 Z M11.5,16 C13.709139,16 15.5,14.209139 15.5,12 C15.5,9.790861 13.709139,8 11.5,8 C9.290861,8 7.5,9.790861 7.5,12 C7.5,14.209139 9.290861,16 11.5,16 Z" fill="#000000" opacity="0.3" transform="translate(11.500000, 12.000000) rotate(-345.000000) translate(-11.500000, -12.000000) "/>
        <path d="M2,6 L21,6 C21.5522847,6 22,6.44771525 22,7 L22,17 C22,17.5522847 21.5522847,18 21,18 L2,18 C1.44771525,18 1,17.5522847 1,17 L1,7 C1,6.44771525 1.44771525,6 2,6 Z M11.5,16 C13.709139,16 15.5,14.209139 15.5,12 C15.5,9.790861 13.709139,8 11.5,8 C9.290861,8 7.5,9.790861 7.5,12 C7.5,14.209139 9.290861,16 11.5,16 Z M11.5,14 C12.6045695,14 13.5,13.1045695 13.5,12 C13.5,10.8954305 12.6045695,10 11.5,10 C10.3954305,10 9.5,10.8954305 9.5,12 C9.5,13.1045695 10.3954305,14 11.5,14 Z" fill="#000000"/>
    </g>
</svg><!--end::Svg Icon--></span><span class="menu-text">Travel Expense</span></a></li>
            </ul>
        </div>
    </div>

</div>
            
            <div class="d-flex flex-column flex-row-fluid wrapper" id="kt_wrapper">

                <div id="kt_header" class="header  header-fixed " >

    
    <div class="container-fluid d-flex align-items-center justify-content-between">
                    <div></div>
        
        <div class="topbar">

    
                        <div class="dropdown">
                
                <div class="topbar-item" data-toggle="dropdown" data-offset="10px,0px">
                    <div class="btn btn-icon btn-clean btn-dropdown btn-lg mr-1">
                        <span class="svg-icon svg-icon-xl svg-icon-primary"><!--begin::Svg Icon | path:public/media/svg/icons/Code/Compiling.svg--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24px" height="24px" viewBox="0 0 24 24" version="1.1">
    <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
        <rect x="0" y="0" width="24" height="24"/>
        <path d="M2.56066017,10.6819805 L4.68198052,8.56066017 C5.26776695,7.97487373 6.21751442,7.97487373 6.80330086,8.56066017 L8.9246212,10.6819805 C9.51040764,11.267767 9.51040764,12.2175144 8.9246212,12.8033009 L6.80330086,14.9246212 C6.21751442,15.5104076 5.26776695,15.5104076 4.68198052,14.9246212 L2.56066017,12.8033009 C1.97487373,12.2175144 1.97487373,11.267767 2.56066017,10.6819805 Z M14.5606602,10.6819805 L16.6819805,8.56066017 C17.267767,7.97487373 18.2175144,7.97487373 18.8033009,8.56066017 L20.9246212,10.6819805 C21.5104076,11.267767 21.5104076,12.2175144 20.9246212,12.8033009 L18.8033009,14.9246212 C18.2175144,15.5104076 17.267767,15.5104076 16.6819805,14.9246212 L14.5606602,12.8033009 C13.9748737,12.2175144 13.9748737,11.267767 14.5606602,10.6819805 Z" fill="#000000" opacity="0.3"/>
        <path d="M8.56066017,16.6819805 L10.6819805,14.5606602 C11.267767,13.9748737 12.2175144,13.9748737 12.8033009,14.5606602 L14.9246212,16.6819805 C15.5104076,17.267767 15.5104076,18.2175144 14.9246212,18.8033009 L12.8033009,20.9246212 C12.2175144,21.5104076 11.267767,21.5104076 10.6819805,20.9246212 L8.56066017,18.8033009 C7.97487373,18.2175144 7.97487373,17.267767 8.56066017,16.6819805 Z M8.56066017,4.68198052 L10.6819805,2.56066017 C11.267767,1.97487373 12.2175144,1.97487373 12.8033009,2.56066017 L14.9246212,4.68198052 C15.5104076,5.26776695 15.5104076,6.21751442 14.9246212,6.80330086 L12.8033009,8.9246212 C12.2175144,9.51040764 11.267767,9.51040764 10.6819805,8.9246212 L8.56066017,6.80330086 C7.97487373,6.21751442 7.97487373,5.26776695 8.56066017,4.68198052 Z" fill="#000000"/>
    </g>
</svg><!--end::Svg Icon--></span>
                    </div>
                </div>

                
                <div class="dropdown-menu p-0 m-0 dropdown-menu-right dropdown-menu-anim-up dropdown-menu-lg shadow-lg">
                    <form>
    <!--begin::Header-->
    <div class="d-flex flex-column pt-12 bgi-size-cover bgi-no-repeat rounded-top py-5" style="background-image: url('https://pismart.pupuk-indonesia.com/public/media/misc/bg-1.jpg')">
        <!--begin::Title-->
        <h4 class="d-flex flex-center rounded-top mb-5">
            <span class="text-white">Modul Aplikasi</span>
            <!-- <span class="btn btn-text btn-success btn-sm font-weight-bold btn-font-md ml-2">23 new</span> -->
        </h4>
        <!--end::Title-->
    </div>
    <!--end::Header-->
    <!--begin::Content-->
    <div class="tab-content">
        <!--begin::Tabpane-->
        <div class="tab-pane active show" id="topbar_notifications_notifications" role="tabpanel">
            <!--begin::Scroll-->
            <div class="navi navi-hover scroll" data-scroll="true" data-height="250" data-mobile-height="200">
                <!--begin::Item-->
                <a href="https://pismart.pupuk-indonesia.com/performance/my_kpi" class="navi-item">
                    <div class="navi-link d-flex align-items-center">
                        <div class="symbol symbol-40 mr-5 shadow-sm">
                            <span class="symbol-label">
                                <span class="svg-icon svg-icon-lg svg-icon-danger">
                                    <!--begin::Svg Icon | path:C:\wamp64\www\keenthemes\legacy\metronic\theme\html\demo1\dist/../src/media/svg/icons\Files\File.svg-->
                                    <img src="https://pismart.pupuk-indonesia.com/public/assets/media/icon-menu/KPI4-22.svg" alt="Kpi" width="50px">
                                    <!--end::Svg Icon-->
                                </span>
                            </span>
                        </div>
                        <div class="navi-text">
                            <div class="text-dark-75 mb-1 font-size-lg">Performance Management System</div>
                            <div class="text-muted">Key Performance Indicator (KPI)</div>
                        </div>
                    </div>
                </a>
                <!--end::Item-->
                <!--begin::Item-->
                <a href="https://pismart.pupuk-indonesia.com/akhlak/my_akhlak" class="navi-item">
                    <div class="navi-link d-flex align-items-center">
                        <div class="symbol symbol-40 mr-5 shadow-sm">
                            <span class="symbol-label">
                                <span class="svg-icon svg-icon-lg svg-icon-primary">
                                    <!--begin::Svg Icon | path:C:\wamp64\www\keenthemes\legacy\metronic\theme\html\demo1\dist/../src/media/svg/icons\General\Star.svg-->
                                    <img src="https://pismart.pupuk-indonesia.com/public/assets/media/icon-menu/AKHLAK-13.svg" alt="Kpi" width="50px">
                                    <!--end::Svg Icon-->
                                </span>
                            </span>
                        </div>
                        <div class="navi-text">
                            <div class="text-dark-75 mb-1 font-size-lg">AKHLAK</div>
                            <div class="text-muted">Penilaian AKHLAK Pegawai</div>
                        </div>
                    </div>
                </a>
                <!--end::Item-->
                <!--begin::Item-->
                <a href="https://pismart.pupuk-indonesia.com/administrasi" class="navi-item">
                    <div class="navi-link d-flex align-items-center">
                        <div class="symbol symbol-40 symbol-light-primary mr-5 shadow-sm">
                            <span class="symbol-label">
                                <span class="svg-icon svg-icon-lg svg-icon-primary">
                                    <!--begin::Svg Icon | path:C:\wamp64\www\keenthemes\legacy\metronic\theme\html\demo1\dist/../src/media/svg/icons\Communication\Add-user.svg-->
                                    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24px" height="24px" viewBox="0 0 24 24" version="1.1">
                                        <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                                            <rect x="0" y="0" width="24" height="24" />
                                            <path d="M8,3 L8,3.5 C8,4.32842712 8.67157288,5 9.5,5 L14.5,5 C15.3284271,5 16,4.32842712 16,3.5 L16,3 L18,3 C19.1045695,3 20,3.8954305 20,5 L20,21 C20,22.1045695 19.1045695,23 18,23 L6,23 C4.8954305,23 4,22.1045695 4,21 L4,5 C4,3.8954305 4.8954305,3 6,3 L8,3 Z" fill="#000000" opacity="0.3" />
                                            <path d="M11,2 C11,1.44771525 11.4477153,1 12,1 C12.5522847,1 13,1.44771525 13,2 L14.5,2 C14.7761424,2 15,2.22385763 15,2.5 L15,3.5 C15,3.77614237 14.7761424,4 14.5,4 L9.5,4 C9.22385763,4 9,3.77614237 9,3.5 L9,2.5 C9,2.22385763 9.22385763,2 9.5,2 L11,2 Z" fill="#000000" />
                                            <rect fill="#000000" opacity="0.3" x="7" y="10" width="5" height="2" rx="1" />
                                            <rect fill="#000000" opacity="0.3" x="7" y="14" width="9" height="2" rx="1" />
                                        </g>
                                    </svg>
                                    <!--end::Svg Icon-->
                                </span>
                            </span>
                        </div>
                        <div class="navi-text">
                            <div class="text-dark-75 mb-1 font-size-lg">Administrasi</div>
                            <div class="text-muted">Administrasi Pegawai</div>
                        </div>
                    </div>
                </a>
                <!--end::Item-->
                <!--begin::Item-->
                <a href="https://pismart.pupuk-indonesia.com/ldms" class="navi-item" target="_blank">
                    <div class="navi-link d-flex align-items-center">
                        <div class="symbol symbol-40 mr-5 shadow-sm">
                            <span class="symbol-label">
                                <span class="svg-icon svg-icon-lg svg-icon-info">
                                    <!--begin::Svg Icon | path:assets/media/svg/icons/Communication/Shield-user.svg-->
                                    <img src="https://pismart.pupuk-indonesia.com/public/assets/media/icon-menu/DIKLAT-18.svg" alt="Kpi" width="50px">
                                    <!--end::Svg Icon-->
                                </span>
                            </span>
                        </div>
                        <div class="navi-text">
                            <div class="text-dark-75 mb-1 font-size-lg">LDMS</div>
                            <div class="text-muted">Aplikasi PI-LDMS</div>
                        </div>
                    </div>
                </a>
                <!--end::Item-->
            </div>
            <!--end::Scroll-->
            <!--begin::Action-->
            <div class="d-flex flex-center py-7">
                <a href="https://pismart.pupuk-indonesia.com/daftar_aplikasi" class="btn btn-light-primary font-weight-bold text-center">Lihat
                    Semua Aplikasi</a>
            </div>
            <!--end::Action-->
        </div>
        <!--end::Tabpane-->
    </div>
    <!--end::Content-->
</form>                </div>
            </div>
            
    
                        <div class="dropdown">
                
                <div class="topbar-item" data-toggle="dropdown" data-offset="10px,0px">
                    <div class="btn btn-icon btn-clean btn-dropdown btn-lg mr-1 pulse pulse-primary">
                        <i class="flaticon2-bell-5 text-primary"></i>
                        <span class="pulse-ring"></span>
                    </div>
                </div>

                
                <div class="dropdown-menu p-0 m-0 dropdown-menu-right dropdown-menu-anim-up dropdown-menu-lg">
                    <form>
                        <div class="d-flex flex-column pt-12 pb-5 bgi-size-cover bgi-no-repeat rounded-top" style="background-image: url('https://pismart.pupuk-indonesia.com/public/media/misc/bg-1.jpg')">
    
    <h4 class="d-flex flex-center rounded-top">
        <span class="text-white">Notifikasi</span>
        <span class="btn btn-text btn-success btn-sm font-weight-bold btn-font-md ml-2 jumlah-notif">1 Notifikasi Baru</span>
    </h4>

    
    <!-- <ul class="nav nav-bold nav-tabs nav-tabs-line nav-tabs-line-2x nav-tabs-line-transparent-white nav-tabs-line-active-border-success mt-3 px-8" role="tablist">
            <li class="nav-item">
                <a class="nav-link active show" data-toggle="tab" href="#topbar_notifications_events"  >Events</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" data-toggle="tab" href="#topbar_notifications_logs"  >Logs</a>
            </li>
        </ul> -->
</div>


<div class="tab-content">

    
    <div class="tab-pane  active show" id="topbar_notifications_events" role="tabpanel">
        
        <div class="navi navi-hover scroll my-4 notif-list" id="topbar-notif-container" data-scroll="true" data-height="300" data-mobile-height="250">
            


            
            


        </div>
    </div>

    
    <!--<div class="tab-pane" id="topbar_notifications_logs" role="tabpanel">
        
        <div class="d-flex flex-center text-center text-muted min-h-200px">
            All caught up!
            <br/>
            No new notifications.
        </div>
    </div>-->
</div>
                    </form>
                </div>
            </div>
            
    
                        <div class="dropdown">
                
                <div class="topbar-item" data-toggle="dropdown" data-offset="0px,0px">
                    <div class="btn btn-icon w-auto btn-clean d-flex align-items-center btn-lg px-2">
                        <span class="text-muted font-weight-bold font-size-base d-none d-md-inline mr-1">Hi,</span>
                        <span class="text-dark-50 font-weight-bolder font-size-base d-none d-md-inline mr-3">Yusuf Wira Kencana Putra (91010187)</span>
                    </div>
                </div>

                
                <div class="dropdown-menu p-0 m-0 dropdown-menu-right dropdown-menu-anim-up dropdown-menu-lg p-0">
                    <div class="d-flex align-items-center justify-content-between flex-wrap p-8 bgi-size-cover bgi-no-repeat rounded-top" style="background-image: url('https://pismart.pupuk-indonesia.com/public/media/misc/bg-1.jpg')">
        <div class="d-flex align-items-center mr-2">
            
            <div class="text-white m-0 flex-grow-1 mr-3 font-size-h5">Yusuf Wira Kencana Putra</div>
        </div>
        <span class="label label-success label-lg font-weight-bold label-inline">91010187</span>
    </div>


<div class="navi navi-spacer-x-0 pt-5">
    
    
    <div class="d-flex justify-content-center">
        <div class="symbol symbol-100 mr-5">
            <img alt="Pic" src="https://pismart.pupuk-indonesia.com/photoKaryawan/819f9c83-da53-4138-a997-d61b6227c938"/>  
            <i class="symbol-badge bg-success"></i>
        </div>
        <div class="d-flex flex-column">
            <div href="#" class="font-weight-bold font-size-h5 text-dark-75 text-hover-primary">Yusuf Wira Kencana Putra</div>
            <div class="navi mt-2">
                <div href="#" class="navi-item">
                    <span class="navi-link p-0 pb-2">
                        <span class="navi-icon mr-1">
                            <span class="svg-icon svg-icon-primary svg-icon-lg"><!--begin::Svg Icon | path:C:\wamp64\www\keenthemes\legacy\metronic\theme\html\demo1\dist/../src/media/svg/icons\General\User.svg--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24px" height="24px" viewBox="0 0 24 24" version="1.1">
                                <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                                    <polygon points="0 0 24 0 24 24 0 24"/>
                                    <path d="M12,11 C9.790861,11 8,9.209139 8,7 C8,4.790861 9.790861,3 12,3 C14.209139,3 16,4.790861 16,7 C16,9.209139 14.209139,11 12,11 Z" fill="#000000" fill-rule="nonzero" opacity="0.3"/>
                                    <path d="M3.00065168,20.1992055 C3.38825852,15.4265159 7.26191235,13 11.9833413,13 C16.7712164,13 20.7048837,15.2931929 20.9979143,20.2 C21.0095879,20.3954741 20.9979143,21 20.2466999,21 C16.541124,21 11.0347247,21 3.72750223,21 C3.47671215,21 2.97953825,20.45918 3.00065168,20.1992055 Z" fill="#000000" fill-rule="nonzero"/>
                                </g>
                            </svg><!--end::Svg Icon--></span>
                        </span>
                        <span class="navi-text text-muted text-hover-primary">91010187</span>
                    </span>
                </div>
                <a href="https://pismart.pupuk-indonesia.com/profile/personal" class="btn btn-sm btn-light-primary font-weight-bolder py-2 px-5">My Profile</a>
            </div>
        </div>
    </div>

    
    <div class="navi-separator mt-3"></div>
    <div class="navi-footer px-8 py-5">
        <a href="https://pismart.pupuk-indonesia.com/logout" class="btn btn-light-danger font-weight-bold btn-lg btn-block">Log Out</a>
    </div>
</div>
                </div>
            </div>
            </div>
    </div>
</div>

                <div class="content  d-flex flex-column flex-column-fluid" id="kt_content">

                                                                        <div class="subheader py-2  subheader-solid " id="kt_subheader">
    <div class=" container-fluid  d-flex align-items-center justify-content-between flex-wrap flex-sm-nowrap">

		
        <div class="d-flex align-items-center flex-wrap mr-1">

			
            <h5 class="text-dark font-weight-bold my-2 mr-5">
                Travel Request

                            </h5>

                    </div>

		
        <div class="d-flex align-items-center">

            
            <!--<div class="dropdown dropdown-inline" data-toggle="tooltip" title="Quick actions" data-placement="left">
                <a href="#" class="btn btn-icon"data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    
                </a>
                <div class="dropdown-menu p-0 m-0 dropdown-menu-md dropdown-menu-right">
                    
                    <ul class="navi navi-hover">
                        <li class="navi-header font-weight-bold">
                            Jump to:
                            <i class="flaticon2-information" data-toggle="tooltip" data-placement="right" title="Click to learn more..."></i>
                        </li>
                        <li class="navi-separator mb-3"></li>
                        <li class="navi-item">
                            <a href="#" class="navi-link">
                                <span class="navi-icon"><i class="flaticon2-drop"></i></span>
                                <span class="navi-text">Recent Orders</span>
                            </a>
                        </li>
                        <li class="navi-item">
                            <a href="#" class="navi-link">
                                <span class="navi-icon"><i class="flaticon2-calendar-8"></i></span>
                                <span class="navi-text">Support Cases</span>
                            </a>
                        </li>
                        <li class="navi-item">
                            <a href="#" class="navi-link">
                                <span class="navi-icon"><i class="flaticon2-telegram-logo"></i></span>
                                <span class="navi-text">Projects</span>
                            </a>
                        </li>
                        <li class="navi-item">
                            <a href="#" class="navi-link">
                                <span class="navi-icon"><i class="flaticon2-new-email"></i></span>
                                <span class="navi-text">Messages</span>
                                <span class="navi-label">
                                    <span class="label label-success label-rounded">5</span>
                                </span>
                            </a>
                        </li>
                        <li class="navi-separator mt-3"></li>
                        <li class="navi-footer">
                            <a class="btn btn-light-primary font-weight-bolder btn-sm" href="#">Upgrade plan</a>
                            <a class="btn btn-clean font-weight-bold btn-sm" href="#" data-toggle="tooltip" data-placement="right" title="Click to learn more...">Learn more</a>
                        </li>
                    </ul>
                </div>
            </div>-->
        </div>

    </div>
</div>
                                            
                    <div class="d-flex flex-column-fluid">
        
        <div class="container-fluid">
            <div class="d-flex flex-column-fluid">
    <!--begin::Container-->
    <div class="container-fluid p-0" id="kt_content_travel">
        <input type="hidden" name="company" id="company" value="A000">
        <input type="hidden" name="nik" id="nik" value="91010187">
        <input type="hidden" name="role" id="role" value="">
        <input type="hidden" name="is_admin" id="is_admin" value="0">
        <!--begin:: Kosongan Brooo-->
        <div class="card card-custom card-transparent">
            <div class="card-body p-0">
                <div class="alert alert-custom alert-light-danger" role="alert" style="display:none;" id="alert_anggaran">
    <div class="alert-icon"><i class="flaticon-warning icon-3x"></i></div>
    <div class="alert-text font-weight-bold font-size-h5">Sisa anggaran kurang dari 10 Juta Rupiah</div>
</div>                <!--begin: Wizard-->
                <div class="wizard wizard-4" id="kt_wizard" data-wizard-state="step-first" data-wizard-clickable="true">
                    <!--begin: Wizard Nav-->
                    <div class="wizard-nav">
                        <div class="wizard-steps">
                            <!--begin::Wizard Step 1 Nav-->
                            <div class="wizard-step" data-wizard-type="step" data-wizard-state="current">
                                <div class="wizard-wrapper">
                                    <div class="wizard-number">1</div>
                                    <div class="wizard-label">
                                        <div class="wizard-title" style="font-size: 13px!important;">Setup</div>
                                        <div class="wizard-desc" style="font-size: 12px!important;">Setup Your Destination</div>
                                    </div>
                                </div>
                            </div>
                            <!--end::Wizard Step 1 Nav-->
                            <!--begin::Wizard Step 2 Nav-->
                            <div class="wizard-step" data-wizard-type="step">
                                <div class="wizard-wrapper">
                                    <div class="wizard-number">2</div>
                                    <div class="wizard-label">
                                        <div class="wizard-title" style="font-size: 13px!important;">Additional Information</div>
                                        <div class="wizard-desc" style="font-size: 12px!important;">Add Detail Information</div>
                                    </div>
                                </div>
                            </div>
                            <!--end::Wizard Step 2 Nav-->
                            <!--begin::Wizard Step 3 Nav-->
                            <div class="wizard-step" data-wizard-type="step">
                                <div class="wizard-wrapper">
                                    <div class="wizard-number">3</div>
                                    <div class="wizard-label">
                                        <div class="wizard-title" style="font-size: 13px!important;">Advances <span class="text-muted"></span></div>
                                        <div class="wizard-desc" style="font-size: 12px!important;">Add a financial plan</div>
                                    </div>
                                </div>
                            </div>
                            <!--end::Wizard Step 3 Nav-->
                            <!--begin::Wizard Step 4 Nav-->
                            <div class="wizard-step" data-wizard-type="step">
                                <div class="wizard-wrapper">
                                    <div class="wizard-number">4</div>
                                    <div class="wizard-label">
                                        <div class="wizard-title" style="font-size: 13px!important;">Completed</div>
                                        <div class="wizard-desc" style="font-size: 12px!important;">Review and Submit</div>
                                    </div>
                                </div>
                            </div>
                            <!--end::Wizard Step 4 Nav-->
                        </div>
                    </div>
                    <!--end: Wizard Nav-->
                    <!--begin: Wizard Body-->
                    <div class="card card-custom card-shadowless rounded-top-0">
                        <div class="card-body p-0">
                            <div class="row justify-content-center py-8 px-8">
                                <div class="col-12">
                                    <!--begin: Wizard Form-->
                                    <form class="form mt-0 mt-lg-10" id="kt_form">
                                        <!--begin: Wizard Step 1-->
                                        <div class="pb-5" data-wizard-type="step-content" data-wizard-state="current">
                                            <div class="mb-5 font-weight-bold text-dark">General Data</div>
                                                                                        <div class="row">
                                                <div class="col-xl-6">
                                                    <input type="hidden" name="id_trip" id="id_trip" value="0">
                                                    <!--begin::Input-->
                                                    <div class="form-group">
                                                        <label>Start Date</label>
                                                        <div class="input-group date" id="start_date" onchange="changeDateTravel()" data-target-input="nearest">
                                                            <input type="text" class="form-control  form-control-lg datetimepicker-input" placeholder="Start date" name="start_date" id="start_date_tgl" data-target="#start_date" />
                                                            <div class="input-group-append" data-target="#start_date" data-toggle="datetimepicker">
                                                                <span class="input-group-text border-0">
                                                                    <i class="ki ki-calendar"></i>
                                                                </span>
                                                            </div>
                                                        </div>
                                                        <span class="form-text text-muted">Please enter start date.</span>
                                                    </div>
                                                    <!--end::Input-->
                                                </div>
                                                <div class="col-xl-6">
                                                    <!--begin::Input-->
                                                    <div class="form-group">
                                                        <label>End Date</label>
                                                        <div class="input-group date" id="end_date" onchange="changeDateTravel()" data-target-input="nearest">
                                                            <input type="text" class="form-control  form-control-lg datetimepicker-input" name="end_date" id="end_date_tgl" placeholder="End date" data-target="#end_date" />
                                                            <div class="input-group-append" data-target="#end_date" data-toggle="datetimepicker">
                                                                <span class="input-group-text border-0">
                                                                    <i class="ki ki-calendar"></i>
                                                                </span>
                                                            </div>
                                                        </div>
                                                        <span class="form-text text-muted">Please enter end date.</span>
                                                    </div>
                                                    <!--end::Input-->
                                                </div>
                                            </div>
                                            <div class="mb-5 font-weight-bold text-dark">Destination</div>
                                            <!--begin::Input-->
                                            <div class="form-group">
                                                <label>Address</label>
                                                <textarea class="form-control  form-control-lg" name="address" id="address" rows="5" placeholder="Fill the destination address"></textarea>
                                                <span class="form-text text-danger">*Required to enter city of destination.</span>
                                            </div>
                                            <!--end::Input-->
                                            <!--begin::Input-->
                                            <div class="form-group">
                                                <label>Country</label>
                                                <select class="form-control  form-control-lg country" name="country" id="country">
                                                </select>
                                                <span class="form-text text-muted">Please select destination country.</span>
                                            </div>
                                            <!--end::Input-->
                                        </div>
                                        <!--end: Wizard Step 1-->
                                        <!--begin: Wizard Step 2-->
                                        <div class="pb-5" data-wizard-type="step-content">
                                            <div class="mb-5 font-weight-bold text-dark">Addtional Information</div>
                                            <div class="row">
                                                <div class="col-xl-6">
                                                    <!--begin::Input-->
                                                    <div class="form-group row">
                                                        <div class="col-12">
                                                            <label>Schema</label>
                                                        </div>
                                                        <div class="col-12">
                                                            <select class="form-control  form-control-lg schema" style="width: 100%!important;" name="schema" id="schema">
                                                            </select>
                                                            <span class="form-text text-muted">Please select schema.</span>
                                                        </div>
                                                    </div>
                                                    <!--end::Input-->
                                                </div>
                                                <div class="col-xl-6">
                                                    <!--begin::Input-->
                                                    <div class="form-group row">
                                                        <div class="col-12">
                                                            <label>Activity (Planning)</label>
                                                        </div>
                                                        <div class="col-12">
                                                            <select class="form-control  form-control-lg activity" style="width: 100%!important;" name="activity" id="activity">
                                                            </select>
                                                            <span class="form-text text-muted">Please select activity.</span>
                                                        </div>
                                                    </div>
                                                    <!--end::Input-->
                                                </div>
                                            </div>
                                            <!--begin::Input-->
                                            <div class="form-group">
                                                <label>Reason</label>
                                                <input type="text" class="form-control  form-control-lg" name="reason" id="reason" placeholder="Enter reason in here" />
                                                <span class="form-text text-muted">Please enter reason.</span>
                                            </div>
                                            <!--end::Input-->
                                            <!--begin::Input-->
                                            <div class="form-group">
                                                <label>Activity Planning Detail</label>
                                                <textarea class="form-control  form-control-lg" name="rincian_aktivitas" id="rincian_aktivitas" rows="5" placeholder="Enter activity planning details"></textarea>
                                                <span class="form-text text-muted">Please enter activity planning detail.</span>
                                            </div>
                                            <!--end::Input-->
                                            <!--begin::Input-->
                                            <div class="form-group">
                                                <label>Pejabat Yang Dihubungi</label>
                                                <input type="text" class="form-control  form-control-lg" name="pejabat_dihubungi" id="pejabat_dihubungi" placeholder="Mohon masukkan pejabat yang dapat dihubungi" />
                                                <span class="form-text text-muted">Mohon masukkan pejabat yang dapat dihubungi.</span>
                                            </div>
                                            <!--end::Input-->
                                        </div>
                                        <!--end: Wizard Step 2-->
                                        <!--begin: Wizard Step 3-->
                                        <div class="pb-5" data-wizard-type="step-content">
                                            <div class="mb-5 font-weight-bold text-dark">Advances <span class="text-muted"></span></div>
                                            <!--begin::Input-->
                                            <div class="form-group mt-4">
                                                <div class="row">
                                                    <div class="col-8">
                                                        <label>Cost Assignment</label>
                                                    </div>
                                                    <div class="col-4 switch_button">
                                                        <label>Use WBS</label>
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-8">
                                                        <select class="form-control  form-control-lg cost_assigment" style="width: 100%!important;" name="cost_assigment" id="cost_assigment">
                                                        </select>
                                                    </div>

                                                    <div class="col-3 switch_button">
                                                        <span class="switch switch-sm switch-outline switch-icon switch-primary">
                                                            <label>
                                                                <input type="checkbox" id="is_wbs" name="select" />
                                                                <span></span>
                                                            </label>
                                                        </span>
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-12">
                                                        <span class="form-text text-muted">Please select cost assigment.</span>
                                                    </div>
                                                </div>
                                            </div>
                                            <!--end::Input-->
                                            <div class="form-group">
                                                <div class="separator separator-dashed my-5"></div>
                                                <div class="mb-5 font-weight-bold text-dark">Cost Center Budget</div>
                                                <div class="text-dark-50 line-height-lg">
                                                    <div class="form-group row mb-3">
                                                        <label class="col-3 col-form-label">Fund Center</label>
                                                        <label class="col-1 text-right px-0">:</label>
                                                        <label class="col-8 px-3 fund_center">-</label>
                                                    </div>
                                                    <div class="form-group row mb-3">
                                                        <label class="col-3 col-form-label">Fund Description</label>
                                                        <label class="col-1 text-right px-0">:</label>
                                                        <label class="col-8 px-3 fund_desc">-</label>
                                                    </div>
                                                    <div class="form-group row mb-3">
                                                        <label class="col-3 col-form-label">Commitment Item</label>
                                                        <label class="col-1 text-right px-0">:</label>
                                                        <label class="col-8 px-3 commit_item">-</label>
                                                    </div>
                                                    <div class="form-group row mb-3">
                                                        <label class="col-3 col-form-label">Description</label>
                                                        <label class="col-1 text-right px-0">:</label>
                                                        <label class="col-8 px-3 desc_budget">-</label>
                                                    </div>
                                                    <div class="form-group row mb-3">
                                                        <label class="col-3 col-form-label">Currency</label>
                                                        <label class="col-1 text-right px-0">:</label>
                                                        <label class="col-8 px-3 kurs">-</label>
                                                    </div>
                                                    <div class="form-group row mb-3">
                                                        <label class="col-3 col-form-label amount_label">Remaining Budget</label>
                                                        <label class="col-1 text-right px-0 amount_label">:</label>
                                                        <label class="col-8 px-3 amount_budget">-</label>
                                                    </div>
                                                </div>
                                                <div class="separator separator-dashed my-5"></div>
                                            </div>
                                            <div class="form-group">
                                                <div class="mb-5 font-weight-bold text-dark">Advances <span class="text-muted"></span></div>
                                                <button type="button" data-toggle="modal" data-target="#advancesModal" onclick="resetModal()" id="btn_advance" class="btn btn-primary font-weight-bold px-6">
                                                    Add Expense
                                                </button>
                                                <!-- <button type="button" onclick="showTable()" id="btn_show_advnc" class="btn btn-warning font-weight-bold px-6">
                                                    Enter Expense
                                                </button> -->
                                                <div class="table-responsive px-0 py-5">
                                                    <table class="table table-bordered text-center table-hover advance_exp_type" id="advance_exp_type">
                                                        <thead>
                                                            <tr>
                                                                <th>#</th>
                                                                <th>Travel. Exp Type</th>
                                                                <th>Nilai <span class="text-muted">(/hari)</span></th>
                                                                <td>Day/Times</span></td>
                                                                <td>Total Price</td>
                                                                <th>Currency</th>
                                                                <th>Information</th>
                                                                <th>Action</th>
                                                            </tr>
                                                        </thead>
                                                        <tbody id="columnDataAdvn">
                                                        </tbody>
                                                        <thead class="total_advance">

                                                        </thead>
                                                    </table>
                                                    <!-- <table class="table table-bordered text-center table-hover total_advance" id="total_advance">
                                                    </table> -->
                                                </div>
                                            </div>
                                            <div class="form-group row">
                                                <label class="col-form-label col-12">Attachment File</label>
                                                <div class="col-12">
                                                    <div class="dropzone dropzone-default dropzone-success" name="attachment[]" id="customFile">
                                                        <div class="dropzone-msg dz-message needsclick">
                                                            <h3 class="dropzone-msg-title">Drop files here or click to upload.</h3>
                                                            <span class="dropzone-msg-desc">Upload up to 15 files and file size maximum 50MB</span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <!--end: Wizard Step 3-->
                                        <!--begin: Wizard Step 4-->
                                        <div class="pb-5" data-wizard-type="step-content">
                                            <!--begin::Section-->
                                            <h4 class="mb-5 font-weight-bold text-dark">Review your Details and Submit</h4>
                                            <h6 class="font-weight-bolder mb-3">General Data :</h6>
                                            <div class="text-dark-50 row line-height-lg">
                                                <div class="col-6">
                                                    <div class="form-group row mb-3 mx-2">
                                                        <label class="col-3 col-form-label p-0">Trip Number</label>
                                                        <label class="col-1 text-right px-0">:</label>
                                                        <label class="col-8 px-3 mb-0" id="trip_number">Not Yet</label>
                                                    </div>
                                                    <div class="form-group row mb-3 mx-2">
                                                        <label class="col-3 col-form-label p-0">Country</label>
                                                        <label class="col-1 text-right px-0">:</label>
                                                        <label class="col-8 px-3" id="country_detail">Madura</label>
                                                    </div>
                                                    <div class="form-group row mb-3 mx-2">
                                                        <label class="col-3 col-form-label p-0">Schema</label>
                                                        <label class="col-1 text-right px-0">:</label>
                                                        <label class="col-8 px-3" id="schema_detail">Lorem ipsum dolor sit amet.</label>
                                                    </div>
                                                </div>
                                                <div class="col-6">
                                                    <div class="form-group row mb-3 mx-2">
                                                        <label class="col-3 col-form-label p-0">Interval Date</label>
                                                        <label class="col-1 text-right px-0">:</label>
                                                        <label class="col-8 px-3 mb-0" id="start_date_detail">20 Januari 2023</label>
                                                    </div>
                                                    <div class="form-group row mb-3 mx-2">
                                                        <label class="col-3 col-form-label p-0">Address</label>
                                                        <label class="col-1 text-right px-0">:</label>
                                                        <label class="col-8 px-3 mb-0" id="address_detail">Cileungsi</label>
                                                    </div>
                                                    <div class="form-group row mb-3 mx-2">
                                                        <label class="col-3 col-form-label p-0">Activity (Planing)</label>
                                                        <label class="col-1 text-right px-0">:</label>
                                                        <label class="col-8 px-3" id="activity_detail">Lorem ipsum dolor sit amet.</label>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="separator separator-dashed sepa my-3"></div>
                                            <h6 class="font-weight-bolder mb-3">Additional Information :</h6>
                                            <div class="text-dark-50 row line-height-lg">
                                                <div class="col-6">
                                                    <div class="form-group row mb-3 mx-2">
                                                        <label class="col-3 col-form-label p-0">Pejabat Yang Dihubungi</label>
                                                        <label class="col-1 text-right px-0">:</label>
                                                        <label class="col-8 px-3" id="pejabat_dihubungi_detail">Lorem ipsum dolor sit.</label>
                                                    </div>
                                                    <div class="form-group row mb-3 mx-2">
                                                        <label class="col-3 col-form-label p-0">Reason</label>
                                                        <label class="col-1 text-right px-0">:</label>
                                                        <label class="col-8 px-3" id="reason_detail">Lorem ipsum dolor sit amet consectetur adipisicing elit. Assumenda sapiente aperiam tempora recusandae et corporis voluptatum quibusdam ipsa?</label>
                                                    </div>
                                                    <div class="form-group row mb-3 mx-2">
                                                        <label class="col-3 col-form-label p-0">Activity Planning Details</label>
                                                        <label class="col-1 text-right px-0">:</label>
                                                        <label class="col-8 px-3" id="rincian_detail">Lorem ipsum dolor sit amet consectetur adipisicing elit. Assumenda sapiente aperiam tempora recusandae et corporis voluptatum quibusdam ipsa?</label>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="separator separator-dashed my-5"></div>
                                            <!--end::Section-->
                                            <!--begin::Section-->
                                            <h6 class="font-weight-bolder mb-3">Advances :</h6>
                                            <div class="text-dark-50 row line-height-lg">
                                                <div class="col-6">
                                                    <div class="form-group row mb-3 mx-2">
                                                        <label class="col-2 col-form-label p-0">Cost Assigment</label>
                                                        <label class="col-1 text-right px-0">:</label>
                                                        <label class="col-5 px-3" id="cost_assign_detail">Lorem ipsum dolor sit.</label>
                                                        <span class="label label-light-success font-weight-bolder label-inline ml-2" id="badge-wbs">WBS</span>
                                                    </div>
                                                </div>
                                                <div class="col-12">
                                                    <div class="form-group row mb-3">
                                                        <label class="col-3 col-form-label font-weight-bold">Cost Center Budget</label>
                                                    </div>
                                                    <div class="text-dark-50 row line-height-lg">
                                                        <div class="col-6">
                                                            <div class="form-group row mb-3 mx-2">
                                                                <label class="col-3 col-form-label p-0">Fund Center</label>
                                                                <label class="col-1 text-right px-0">:</label>
                                                                <label class="col-8 px-3 fund_center">Lorem ipsum dolor sit amet.</label>
                                                            </div>
                                                            <div class="form-group row mb-3 mx-2">
                                                                <label class="col-3 col-form-label p-0">Commitment Item</label>
                                                                <label class="col-1 text-right px-0">:</label>
                                                                <label class="col-8 px-3 commit_item">Lorem ipsum dolor sit amet consectetur adipisicing elit. Assumenda sapiente aperiam tempora recusandae et corporis voluptatum quibusdam ipsa?</label>
                                                            </div>
                                                        </div>
                                                        <div class="col-6">
                                                            <div class="form-group row mb-3 mx-2">
                                                                <label class="col-3 col-form-label p-0">Description</label>
                                                                <label class="col-1 text-right px-0">:</label>
                                                                <label class="col-8 px-3 desc_budget">Lorem ipsum dolor sit amet consectetur adipisicing elit. Assumenda sapiente aperiam tempora recusandae et corporis voluptatum quibusdam ipsa?</label>
                                                            </div>
                                                            <div class="form-group row mb-3 mx-2">
                                                                <label class="col-3 col-form-label p-0 amount_label">Remaining Budget</label>
                                                                <label class="col-1 text-right px-0 amount_label">:</label>
                                                                <label class="col-8 px-3 amount_budget">Lorem ipsum dolor sit.</label>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="form-group row mb-3">
                                                        <label class="col-3 col-form-label font-weight-bold">Advances</label>
                                                        <div class="table-responsive px-5 py-0">
                                                            <table class="table table-bordered text-center table-hover display nowrap advance_exp_type" id="advance_exp_type_detail">
                                                                <thead>
                                                                    <tr>
                                                                        <th>#</th>
                                                                        <th>Travel. Exp Type</th>
                                                                        <th>Nilai <span class="text-muted">(/hari)</span></th>
                                                                        <td>Day/Times</span></td>
                                                                        <td>Total Price</td>
                                                                        <th>Currency</th>
                                                                        <th colspan="2">Information</th>
                                                                    </tr>
                                                                </thead>
                                                                <tbody id="columnDataAdvn_detail">
                                                                </tbody>
                                                                <thead class="total_advance">

                                                                </thead>
                                                            </table>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="separator separator-dashed my-5"></div>
                                            <h6 class="font-weight-bolder mb-3">Approver :</h6>
                                            <div class="text-dark-50 line-height-lg">
                                                <div class="row" id="list_approver"></div>
                                            </div>
                                            <!--end::Section-->
                                        </div>
                                        <!--end: Wizard Step 4-->
                                        <!--begin: Wizard Actions-->
                                        <div class="d-flex justify-content-between border-top mt-5 pt-10">
                                            <div class="mr-2">
                                                <button type="button" class="btn btn-light-primary font-weight-bolder text-uppercase px-9" onclick="hideDraft()" data-wizard-type="action-prev">Previous</button>
                                            </div>
                                            <div>
                                                <button type="button" class="btn btn-warning font-weight-bolder text-uppercase px-9" onclick="storeAction('Drafted')" id="btn_draft">Save as draft</button>
                                                <button type="button" class="btn btn-success font-weight-bolder text-uppercase px-9" data-wizard-type="action-submit">Submit</button>
                                                <button type="button" class="btn btn-primary font-weight-bolder text-uppercase px-9" data-wizard-type="action-next">Next</button>
                                            </div>
                                        </div>
                                        <!--end: Wizard Actions-->
                                    </form>
                                    <!--end: Wizard Form-->
                                </div>
                            </div>
                        </div>
                    </div>
                    <!--end: Wizard Bpdy-->
                </div>
                <!--end: Wizard-->
            </div>
        </div>
        <!--end:: Kosongan Brooo-->
    </div>
    <!--end::Container-->
</div>
<!-- Modal-->
<div class="modal fade" id="advancesModal" data-backdrop="static" tabindex="-1" role="dialog" aria-labelledby="staticBackdrop" aria-hidden="true">
    <div class="modal-dialog modal-xl modal-dialog-centered modal-dialog-scrollable" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="advancesModalLabel">Expense</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <i aria-hidden="true" class="ki ki-close"></i>
                </button>
            </div>
            <div class="modal-body">
                <input type="hidden" name="local_id" id="local_id">
                <input type="hidden" class="form-control form-control-lg" name="id_request" id="id_request" value="0" />
                <input type="hidden" class="form-control form-control-lg" name="editable" id="editable" />
                <div class="form-group row">
                    <div class="col-12">
                        <label>Travel Expense Type<span class="text-danger">*</span></label>
                    </div>
                    <div class="col-12">
                        <select class="form-control form-control-lg exp_type" style="width: 100%!important;" name="exp_type" id="exp_type" require>
                        </select>
                    </div>
                </div>
                <div class="form-group row">
                    <div class="col-12">
                        <label>Currency<span class="text-danger">*</span></label>
                    </div>
                    <div class="col-12">
                        <input type="hidden" name="currency_hidden" id="currency_hidden">
                        <select class="form-control form-control-lg currency_modal" onchange="changeCurrency()" style="width: 100%!important;" name="currency_modal" id="currency_modal" require>
                            <option value=""></option>
                            <option value="IDR">IDR</option>
                            <option value="USD">USD</option>
                        </select>
                    </div>
                </div>
                <div class="form-group row">
                    <div class="col-6">
                        <label>Nilai <span class="text-muted">(/hari)</span><span class="text-danger">*</span></label>
                        <input type="number" class="form-control  form-control-lg" name="amount_modal" oninput="sumDetailExpenseType()" onchange="maxPlafon(this)" id="amount_modal" placeholder="Input Price" readonly />
                    </div>
                    <div class="col-6">
                        <label>Day/Times<span class="text-danger">*</span></label>
                        <input type="number" step="1" class="form-control  form-control-lg" name="days_modal" oninput="sumDetailExpenseType()" onchange="maxDays()" id="days_modal" min="0" value="0" readonly />
                    </div>
                </div>
                <div class="form-group">
                    <label>Total Price</label>
                    <input type="number" class="form-control form-control-solid form-control-lg" name="total_price_modal" id="total_price_modal" readonly />
                </div>
                <div class="form-group">
                    <label>Information</label>
                    <textarea class="form-control  form-control-lg" name="description_modal" id="description_modal" placeholder="Enter description advances" rows="3"></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-light-primary font-weight-bold" data-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary font-weight-bold" onclick="addAdvancesType()">Save</button>
            </div>
        </div>
    </div>
</div>
        </div>
    </div>
                </div>

                <div class="footer bg-white py-4 d-flex flex-lg-column " id="kt_footer">
    
    <div class=" container-fluid  d-flex flex-column flex-md-row align-items-center justify-content-between">
        
        <div class="text-dark order-2 order-md-1">
            <span class="text-muted font-weight-bold mr-2">2024 &copy;</span>
            <a href="javascript:void();" class="text-dark-75 text-hover-primary">PI-Smart</a>
        </div>

        
        <div class="nav nav-dark order-1 order-md-2">
            <a href="https://pismart.pupuk-indonesia.com/panduan_pengguna"  class="nav-link pr-3 pl-0">Panduan Pengguna</a>
            <a href="https://pismart.pupuk-indonesia.com/kebijakan_privasi"  class="nav-link pr-3 pl-0">Kebijakan Privasi</a>
            <!--<a href="https://keenthemes.com/metronic" target="_blank" class="nav-link px-3">Team</a>
            <a href="https://keenthemes.com/metronic" target="_blank" class="nav-link pl-3 pr-0">Contact</a>-->
        </div>
    </div>
</div>
            </div>
        </div>
    </div>



    
    
    
    
    
    
            <div class="modal modal-sticky modal-sticky-bottom-right" id="kt_chat_modal" role="dialog" data-backdrop="false">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            
            <div class="card card-custom">
                
                <div class="card-header align-items-center px-4 py-3">
                    <div class="text-left flex-grow-1">
                        
                        <div class="dropdown dropdown-inline">
                            <button type="button" class="btn btn-clean btn-sm btn-icon btn-icon-md" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                <span class="svg-icon svg-icon-lg"><!--begin::Svg Icon | path:public/media/svg/icons/Communication/Add-user.svg--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24px" height="24px" viewBox="0 0 24 24" version="1.1">
    <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
        <polygon points="0 0 24 0 24 24 0 24"/>
        <path d="M18,8 L16,8 C15.4477153,8 15,7.55228475 15,7 C15,6.44771525 15.4477153,6 16,6 L18,6 L18,4 C18,3.44771525 18.4477153,3 19,3 C19.5522847,3 20,3.44771525 20,4 L20,6 L22,6 C22.5522847,6 23,6.44771525 23,7 C23,7.55228475 22.5522847,8 22,8 L20,8 L20,10 C20,10.5522847 19.5522847,11 19,11 C18.4477153,11 18,10.5522847 18,10 L18,8 Z M9,11 C6.790861,11 5,9.209139 5,7 C5,4.790861 6.790861,3 9,3 C11.209139,3 13,4.790861 13,7 C13,9.209139 11.209139,11 9,11 Z" fill="#000000" fill-rule="nonzero" opacity="0.3"/>
        <path d="M0.00065168429,20.1992055 C0.388258525,15.4265159 4.26191235,13 8.98334134,13 C13.7712164,13 17.7048837,15.2931929 17.9979143,20.2 C18.0095879,20.3954741 17.9979143,21 17.2466999,21 C13.541124,21 8.03472472,21 0.727502227,21 C0.476712155,21 -0.0204617505,20.45918 0.00065168429,20.1992055 Z" fill="#000000" fill-rule="nonzero"/>
    </g>
</svg><!--end::Svg Icon--></span>
                            </button>
                            <div class="dropdown-menu p-0 m-0 dropdown-menu-right dropdown-menu-md">
                                
                                <ul class="navi navi-hover py-5">
                                    <li class="navi-item">
                                        <a href="#" class="navi-link">
                                            <span class="navi-icon"><i class="navi-icon flaticon2-group"></i></span>
                                            <span class="navi-text">New Group</span>
                                        </a>
                                    </li>
                                    <li class="navi-item">
                                        <a href="#" class="navi-link">
                                            <span class="navi-icon"><i class="flaticon2-open-text-book"></i></span>
                                            <span class="navi-text">Contacts</span>
                                        </a>
                                    </li>
                                    <li class="navi-item">
                                        <a href="#" class="navi-link">
                                            <span class="navi-icon"><i class="navi-icon flaticon2-rocket-1"></i></span>
                                            <span class="navi-text">Groups</span>
                                            <span class="navi-link-badge">
                                                <span class="label label-primary label-inline">new</span>
                                            </span>
                                        </a>
                                    </li>
                                    <li class="navi-item">
                                        <a href="#" class="navi-link">
                                            <span class="navi-icon"><i class="navi-icon flaticon2-bell-2"></i></span>
                                            <span class="navi-text">Calls</span>
                                        </a>
                                    </li>
                                    <li class="navi-item">
                                        <a href="#" class="navi-link">
                                            <span class="navi-icon"><i class="navi-icon flaticon2-dashboard"></i></span>
                                            <span class="navi-text">Settings</span>
                                        </a>
                                    </li>

                                    <li class="navi-separator my-3"></li>

                                    <li class="navi-item">
                                        <a href="#" class="navi-link">
                                            <span class="navi-icon"><i class="navi-icon flaticon2-protected"></i></span>
                                            <span class="navi-text">Help</span>
                                        </a>
                                    </li>
                                    <li class="navi-item">
                                        <a href="#" class="navi-link">
                                            <span class="navi-icon"><i class="navi-icon flaticon2-bell-2"></i></span>
                                            <span class="navi-text">Privacy</span>
                                        </a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="text-center flex-grow-1">
                        <div class="text-dark-75 font-weight-bold font-size-h5">Matt Pears</div>
                        <div>
                            <span class="label label-dot label-success"></span>
                            <span class="font-weight-bold text-muted font-size-sm">Active</span>
                        </div>
                    </div>
                    <div class="text-right flex-grow-1">
                        <button type="button" class="btn btn-clean btn-sm btn-icon btn-icon-md"  data-dismiss="modal">
                            <i class="ki ki-close icon-1x"></i>
                        </button>
                    </div>
                </div>

                
                <div class="card-body">
                    
                    <div class="scroll scroll-pull" data-height="400" data-mobile-height="350">
                        
                        <div class="messages">
                            
                            <div class="d-flex flex-column mb-5 align-items-start">
                                <div class="d-flex align-items-center">
                                    <div class="symbol symbol-circle symbol-40 mr-3">
                                        <img alt="Pic" src="https://pismart.pupuk-indonesia.com/public/media/users/300_12.jpg"/>
                                    </div>
                                    <div>
                                        <a href="#" class="text-dark-75 text-hover-primary font-weight-bold font-size-h6">Matt Pears</a>
                                        <span class="text-muted font-size-sm">2 Hours</span>
                                    </div>
                                </div>
                                <div class="mt-2 rounded p-5 bg-light-success text-dark-50 font-weight-bold text-left max-w-400px">
                                    How likely are you to recommend our company
                                    to your friends and family?
                                </div>
                            </div>

                            
                            <div class="d-flex flex-column mb-5 align-items-end">
                                <div class="d-flex align-items-center">
                                    <div>
                                        <span class="text-muted font-size-sm">3 minutes</span>
                                        <a href="#" class="text-dark-75 text-hover-primary font-weight-bold font-size-h6">You</a>
                                    </div>
                                    <div class="symbol symbol-circle symbol-40 ml-3">
                                        <img alt="Pic" src="https://pismart.pupuk-indonesia.com/public/media/users/300_21.jpg"/>
                                    </div>
                                </div>
                                <div class="mt-2 rounded p-5 bg-light-primary text-dark-50 font-weight-bold text-right max-w-400px">
                                    Hey there, we’re just writing to let you know
                                    that you’ve been subscribed to a repository on GitHub.
                                </div>
                            </div>

                            
                            <div class="d-flex flex-column mb-5 align-items-start">
                                <div class="d-flex align-items-center">
                                    <div class="symbol symbol-circle symbol-40 mr-3">
                                        <img alt="Pic" src="https://pismart.pupuk-indonesia.com/public/media/users/300_21.jpg"/>
                                    </div>
                                    <div>
                                        <a href="#" class="text-dark-75 text-hover-primary font-weight-bold font-size-h6">Matt Pears</a>
                                        <span class="text-muted font-size-sm">40 seconds</span>
                                    </div>
                                </div>
                                <div class="mt-2 rounded p-5 bg-light-success text-dark-50 font-weight-bold text-left max-w-400px">
                                    Ok, Understood!
                                </div>
                            </div>

                            
                            <div class="d-flex flex-column mb-5 align-items-end">
                                <div class="d-flex align-items-center">
                                    <div>
                                        <span class="text-muted font-size-sm">Just now</span>
                                        <a href="#" class="text-dark-75 text-hover-primary font-weight-bold font-size-h6">You</a>
                                    </div>
                                    <div class="symbol symbol-circle symbol-40 ml-3">
                                        <img alt="Pic" src="https://pismart.pupuk-indonesia.com/public/media/users/300_21.jpg"/>
                                    </div>
                                </div>
                                <div class="mt-2 rounded p-5 bg-light-primary text-dark-50 font-weight-bold text-right max-w-400px">
                                    You’ll receive notifications for all issues, pull requests!
                                </div>
                            </div>

                            
                            <div class="d-flex flex-column mb-5 align-items-start">
                                <div class="d-flex align-items-center">
                                    <div class="symbol symbol-circle symbol-40 mr-3">
                                        <img alt="Pic" src="https://pismart.pupuk-indonesia.com/public/media/users/300_12.jpg"/>
                                    </div>
                                    <div>
                                        <a href="#" class="text-dark-75 text-hover-primary font-weight-bold font-size-h6">Matt Pears</a>
                                        <span class="text-muted font-size-sm">40 seconds</span>
                                    </div>
                                </div>
                                <div class="mt-2 rounded p-5 bg-light-success text-dark-50 font-weight-bold text-left max-w-400px">
                                    You can unwatch this repository immediately by clicking here: <a href="#">https://github.com</a>
                                </div>
                            </div>

                            
                            <div class="d-flex flex-column mb-5 align-items-end">
                                <div class="d-flex align-items-center">
                                    <div>
                                        <span class="text-muted font-size-sm">Just now</span>
                                        <a href="#" class="text-dark-75 text-hover-primary font-weight-bold font-size-h6">You</a>
                                    </div>
                                    <div class="symbol symbol-circle symbol-40 ml-3">
                                        <img alt="Pic" src="https://pismart.pupuk-indonesia.com/public/media/users/300_21.jpg"/>
                                    </div>
                                </div>
                                <div class="mt-2 rounded p-5 bg-light-primary text-dark-50 font-weight-bold text-right max-w-400px">
                                    Discover what students who viewed Learn Figma - UI/UX Design. Essential Training also viewed
                                </div>
                            </div>

                            
                            <div class="d-flex flex-column mb-5 align-items-start">
                                <div class="d-flex align-items-center">
                                    <div class="symbol symbol-circle symbol-40 mr-3">
                                        <img alt="Pic" src="https://pismart.pupuk-indonesia.com/public/media/users/300_12.jpg"/>
                                    </div>
                                    <div>
                                        <a href="#" class="text-dark-75 text-hover-primary font-weight-bold font-size-h6">Matt Pears</a>
                                        <span class="text-muted font-size-sm">40 seconds</span>
                                    </div>
                                </div>
                                <div class="mt-2 rounded p-5 bg-light-success text-dark-50 font-weight-bold text-left max-w-400px">
                                    Most purchased Business courses during this sale!
                                </div>
                            </div>

                            
                            <div class="d-flex flex-column mb-5 align-items-end">
                                <div class="d-flex align-items-center">
                                    <div>
                                        <span class="text-muted font-size-sm">Just now</span>
                                        <a href="#" class="text-dark-75 text-hover-primary font-weight-bold font-size-h6">You</a>
                                    </div>
                                    <div class="symbol symbol-circle symbol-40 ml-3">
                                        <img alt="Pic" src="https://pismart.pupuk-indonesia.com/public/media/users/300_21.jpg"/>
                                    </div>
                                </div>
                                <div class="mt-2 rounded p-5 bg-light-primary text-dark-50 font-weight-bold text-right max-w-400px">
                                    Company BBQ to celebrate the last quater achievements and goals. Food and drinks provided
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                
                <div class="card-footer align-items-center">
                    
                    <textarea class="form-control border-0 p-0" rows="2" placeholder="Type a message"></textarea>
                    <div class="d-flex align-items-center justify-content-between mt-5">
                        <div class="mr-3">
                            <a href="#" class="btn btn-clean btn-icon btn-md mr-1"><i class="flaticon2-photograph icon-lg"></i></a>
                            <a href="#" class="btn btn-clean btn-icon btn-md"><i class="flaticon2-photo-camera  icon-lg"></i></a>
                        </div>
                        <div>
                            <button type="button" class="btn btn-primary btn-md text-uppercase font-weight-bold chat-send py-2 px-6">Send</button>
                        </div>
                    </div>
                    
                </div>
            </div>
        </div>
    </div>
</div>
    
    <div id="kt_scrolltop" class="scrolltop">
	<span class="svg-icon"><!--begin::Svg Icon | path:public/media/svg/icons/Navigation/Up-2.svg--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24px" height="24px" viewBox="0 0 24 24" version="1.1">
    <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
        <polygon points="0 0 24 0 24 24 0 24"/>
        <rect fill="#000000" opacity="0.3" x="11" y="10" width="2" height="10" rx="1"/>
        <path d="M6.70710678,12.7071068 C6.31658249,13.0976311 5.68341751,13.0976311 5.29289322,12.7071068 C4.90236893,12.3165825 4.90236893,11.6834175 5.29289322,11.2928932 L11.2928932,5.29289322 C11.6714722,4.91431428 12.2810586,4.90106866 12.6757246,5.26284586 L18.6757246,10.7628459 C19.0828436,11.1360383 19.1103465,11.7686056 18.7371541,12.1757246 C18.3639617,12.5828436 17.7313944,12.6103465 17.3242754,12.2371541 L12.0300757,7.38413782 L6.70710678,12.7071068 Z" fill="#000000" fill-rule="nonzero"/>
    </g>
</svg><!--end::Svg Icon--></span>
	
</div>


    
    <script>
        var KTAppSettings = {
    "breakpoints": {
        "sm": 576,
        "md": 768,
        "lg": 992,
        "xl": 1200,
        "xxl": 1200
    },
    "colors": {
        "theme": {
            "base": {
                "white": "#ffffff",
                "primary": "#6993FF",
                "secondary": "#E5EAEE",
                "success": "#1BC5BD",
                "info": "#8950FC",
                "warning": "#FFA800",
                "danger": "#F64E60",
                "light": "#F3F6F9",
                "dark": "#212121"
            },
            "light": {
                "white": "#ffffff",
                "primary": "#E1E9FF",
                "secondary": "#ECF0F3",
                "success": "#C9F7F5",
                "info": "#EEE5FF",
                "warning": "#FFF4DE",
                "danger": "#FFE2E5",
                "light": "#F3F6F9",
                "dark": "#D6D6E0"
            },
            "inverse": {
                "white": "#ffffff",
                "primary": "#ffffff",
                "secondary": "#212121",
                "success": "#ffffff",
                "info": "#ffffff",
                "warning": "#ffffff",
                "danger": "#ffffff",
                "light": "#464E5F",
                "dark": "#ffffff"
            }
        },
        "gray": {
            "gray-100": "#F3F6F9",
            "gray-200": "#ECF0F3",
            "gray-300": "#E5EAEE",
            "gray-400": "#D6D6E0",
            "gray-500": "#B5B5C3",
            "gray-600": "#80808F",
            "gray-700": "#464E5F",
            "gray-800": "#1B283F",
            "gray-900": "#212121"
        }
    },
    "font-family": "Poppins"
};
    </script>

    
        <script src="https://pismart.pupuk-indonesia.com/public/plugins/global/plugins.bundle.js" type="text/javascript"></script>
        <script src="https://pismart.pupuk-indonesia.com/public/plugins/custom/prismjs/prismjs.bundle.js" type="text/javascript"></script>
        <script src="https://pismart.pupuk-indonesia.com/public/js/scripts.bundle.js" type="text/javascript"></script>
        <!-- Sweet Alert -->
    <script src="https://pismart.pupuk-indonesia.com/public/assets/js/pages/features/miscellaneous/sweetalert2.js"></script>
    <script src="https://pismart.pupuk-indonesia.com/public/assets/js/pages/features/miscellaneous/blockui.js"></script>

    <script type="text/javascript">
        var browserDetail;
        async function initFingerPrint() {
            // Initialize an agent at application startup.
            const fpPromise = FingerprintJS.load()
            const fp = await fpPromise
            browserDetail = await fp.get().visitorId
            // Get the visitor identifier when you need it.
            /*fpPromise
            .then(fp => fp.get())
            .then(result => {
                // This is the visitor identifier:
                browserDetail = result.visitorId
            })*/
        }
    </script>

    <script src="//cdn.jsdelivr.net/npm/@fingerprintjs/fingerprintjs@3/dist/fp.min.js" onload="initFingerPrint()"></script>

    <script>
        var base_url = 'https://pismart.pupuk-indonesia.com';
        $.ajaxSetup({
            headers: {
                'X-CSRF-TOKEN': $('meta[name="csrf-token"]').attr('content')
            }
        });
    </script>

    <script>
        // get list notification
        $.ajax({
            url: base_url + '/notification/getlist',
            method: 'post',
            dataType: 'json',
            success: function(data) {

            },
            error: function(jxhr) {
                console.log(jxhr);

                //doing something make empty the list notificatoin
                $('#topbar-notif-container').html(
                    `
                        <div class="d-flex flex-center text-center text-muted min-h-200px">
                            All caught up!
                            <br/>
                            Tidak ada Notifikasi Baru
                        </div>
                    `);
                // handleUnauthorized(jxhr.status, jxhr);
            }
        })
    </script>

    <!-- The core Firebase JS SDK is always required and must be listed first -->
    <script src="https://www.gstatic.com/firebasejs/8.8.0/firebase-app.js"></script>

    <script src="https://www.gstatic.com/firebasejs/8.8.0/firebase-messaging.js"></script>

    <!-- TODO: Add SDKs for Firebase products that you want to use
             https://firebase.google.com/docs/web/setup#available-libraries -->
    <!-- <script src="https://www.gstatic.com/firebasejs/8.8.0/firebase-analytics.js"></script> -->

    <script src="https://pismart.pupuk-indonesia.com/public/assets/js/pages/features/miscellaneous/bootstrap-notify.js"></script>
    <script src="https://pismart.pupuk-indonesia.com/public/plugins/global/ion.sound-3.0.7/ion.sound.min.js"></script>

    <script>
        var token_oauth = $('#token_oauth').val();
        // console.log(token_oauth);
    </script>

    <script>
        //initilize sound plugins and load sound
        ion.sound({
            sounds: [{
                name: "bell_ring"
            }],
            volume: 1.0,
            path: "public/plugins/global/ion.sound-3.0.7/sounds/",
            preload: false
        });
    </script>

    <script src="https://pismart.pupuk-indonesia.com/public/js/firebase.js"></script>
    <script>
        function handleUnauthorized(res, endpoint = null) {
            var base_url = 'https://pismart.pupuk-indonesia.com/';
            var user_login = '91010187';

            if (res.status != 404 || res.status != 400) {
                $.ajax({
                    headers: {
                        'X-CSRF-TOKEN': $('meta[name="csrf-token"]').attr('content')
                    },
                    url: base_url + 'log_ajax',
                    type: "POST",
                    data: {
                        "status_code": res.status,
                        "content": res.responseText ? res.responseText : 'Connection Timeout',
                        "user": user_login,
                        "endpoint": endpoint ? endpoint : 'undefined',
                    },
                    success: function(response) {}
                });
            }

            if (res.status == 401) {
                Swal.fire({
                    title: res.status,
                    text: res.responseText ? res.responseText : 'Token Expired',
                    icon: "info",
                    allowOutsideClick: false,
                    showCancelButton: false,
                    showConfirmButton: true,
                }).then(function() {
                    window.location.href = "https://pismart.pupuk-indonesia.com/logout";
                })
            }
        }

        function PersentaseFunc(realisasi, target, polaritas) {
            var persentase = 0;
            if (polaritas == "MIN") {
                persentase = (parseFloat(target) / parseFloat(realisasi) * 100).toFixed(2);
            } else {
                persentase = (parseFloat(realisasi) / parseFloat(target) * 100).toFixed(2);
            }
            return persentase;
        }
        //global year variable
        var current_year = new Date().getFullYear();
        selectYear(current_year)

        function selectYear(year) {
            var start_year = new Date();
            start_year.setFullYear(year - 1)
            var html =
                '<select class="form-control selectpicker" id="kpi_year" data-style="btn-primary">' +
                '<optgroup label="Periode Tahun" id="listYear">' +
                '</optgroup>' +
                '</select>'
            $('#selectYear').html(html)
            var get_year = start_year.getFullYear()-1;
            var dateNow = start_year.getDate()+'-'+start_year.getMonth()
            for (let i = 0; i < 3; i++) {
                if (get_year == (current_year)) {
                    $('#listYear').append($("<option></option>").attr({
                        value: get_year,
                        selected: 'selected'
                    }).text('Periode thn ' + get_year));
                } else {
                    $('#listYear').append($("<option></option>").attr('value', get_year).text('Periode thn ' +
                        get_year));
                }
                get_year++
            }
            $('#kpi_year').selectpicker('refresh')
            if (start_year.getDate() == 1 && start_year.getMonth()>0) {
                $('#kpi_year').selectpicker('val', start_year.getFullYear()-1)
            }else{
                $('#kpi_year').selectpicker('val', start_year.getFullYear())
            }

        }

        function formatRupiah(angka, prefix) {
            if (angka == 0.00) {
                return 0;
            }
            var number_string = angka.replace(/[^.\d]/g, '').toString(),
                split = number_string.split('.'),
                sisa = split[0].length % 3,
                rupiah = split[0].substr(0, sisa),
                ribuan = split[0].substr(sisa).match(/\d{3}/gi);

            if (ribuan) {
                separator = sisa ? ',' : '';
                rupiah += separator + ribuan.join(',');
            }

            rupiah = split[1] != undefined ? rupiah + '.' + split[1] : rupiah;
            return prefix == undefined ? rupiah : (rupiah ? '' + rupiah : '');
        }
    </script>

    
    <script src="https://pismart.pupuk-indonesia.com/public/assets/js/pages/custom/wizard/wizard-4.js"></script>
<script src="https://pismart.pupuk-indonesia.com/public/plugins/custom/datatables/datatables.bundle.js" type="text/javascript"></script>
<script src="https://pismart.pupuk-indonesia.com/public/plugins/custom/prismjs/prismjs.bundle.js"></script>
<script src="https://pismart.pupuk-indonesia.com/public/js/scripts.bundle.js"></script>
<script>
    var base_url_web = 'https://pismart.pupuk-indonesia.com/';
    var base_url_api = 'https://api-pismart.pupuk-indonesia.com/oauth_api/';
    var token_oauth = 'eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJhdWQiOiIxMjQ4IiwianRpIjoiM2QxNTY2ZGM5NzM0NzcwYmIzNzJkZmUxNTI2M2IwNzE1ZmQ5NWU1YmI0OGM0YWYxMzEwMzA0ZWFjMDc2MzM0YjRkY2NjNmQxZGFlMzI2YzgiLCJpYXQiOjE3MDYxNDc5MTIuNjYwOTA4LCJuYmYiOjE3MDYxNDc5MTIuNjYwOTExLCJleHAiOjE3Mzc3NzAzMTIuNjE2MTUxLCJzdWIiOiIxMDg4Iiwic2NvcGVzIjpbXX0.pqA6RKgDx6YDOAbbiUS1XkqYLW4rc4E-vpyqXyGQ9r6-1T61WJorGXh7l6cwCgisfUyGhcU5QJwWyVT2cX70Zhelil9uxTA-IhFJELykwE7PPUIZYxov5sIGMvqsbtikNOxfYbkogmKHxqSQyTdGqW2G53ZRgaPBrSLLiOM1IAKty8IYQdo-Xs3vOyrL_mArsPnMoVHcytbhk_i-VjMKcaWYLhq_A09Av1SZrwX4SN7Wy2c5jI1SFaAp5SmkJN7rR8YNRYCJfXq6s5g5O0WFwMrnY0cl8oSbY8_QXBPfUHCdB1NXl1yf1foPKxNPS9KoUm0r68MeGsafbNTFf66CT2KLxvhebBHeyJKYr6XqV_Fq9MW3oHtXEj17yx4shl0rFs0PitLKIHEURJlJCtS1bLERBGabd3yPV3NoP-FalcUdNDPJ18h0b5Z9tA79-pqsxQzf3P-MZhR3NUpspRdmnofErMTGlMM_HClIRXBSMBeHGtqit9EjPGrW93skUX70rpyaWCvrJ4W9nRfy1IqWHB0j7RJkPN8h93Twd9KnByBJFQPTqg8lYcJUM29zX2zwL_6dR-Hp6y7JtLf0GrW0XdrBn-Mtbw-D8wIDvQnla-dzoTNsUk1hq_a0Z7kZNT4S6Zhh5SpGDHcApf2hEN7tZ8vawQRAJDGJvPaWgSj6zw0';
    var emp_no = $("#nik").val();
    var company = $("#company").val();
    var year = $('#kpi_year').val();
    var id_schema = null
    var id_activity = null
    var costCenter = null
    var arr_exp_type = []
    var arr_exp_type_default = []
    var advnc_exp_type = [];
    var index_tabel = 1;
    var start_date = null
    var end_date = null
    var remaining_budget = 0
    var total_exp_default = 0
    var ccDefault = null
    var arr_approver = []
    var id_trip = $('#id_trip').val() ?? null
    var file_attach = []
    var local_id = 1;
    var useWbs = 0;
    var company_role = $("#role").val();
    var is_admin = $("#is_admin").val();
    var com_code_user = null

    $('#kpi_year').on('change', function() {
        year = $('#kpi_year').val();
    })
    if (id_trip != 0) {
        showDataById(id_trip)
    } else {
        initDropzone()
        getCountry()
        if (is_admin == 0) {
            getApprover()
        }
    }

    if (company_role != '9999') {
        perusahaan = company_role;
        com_code_user = company_role
    }

    $(document).ready(function() {
        $('#btn_draft').hide();
        $('.country').select2({
            placeholder: "Select destination country",
            allowClear: true,
        });
        $('.activity').select2({
            placeholder: "Select Activity",
            allowClear: true,
        });
        $('.schema').select2({
            placeholder: "Select Schema",
            allowClear: true,
        });
        $('.cost_assigment').select2({
            placeholder: "Select Cost Assigment",
            allowClear: true,
        });
        $('.exp_type').select2({
            placeholder: "Select Cost Expense Type",
            allowClear: true,
        });
        $('#currency_modal').select2({
            placeholder: "Select Currency",
            allowClear: true,
        });

        $('#start_date').datetimepicker({
            format: 'YYYY-MM-DD'
        });
        $('#end_date').datetimepicker({
            useCurrent: false,
            format: 'YYYY-MM-DD'
        });

        $('#start_date').on('change.datetimepicker', function(e) {
            $('#end_date').datetimepicker('minDate', e.date);
        });
        $('#end_date').on('change.datetimepicker', function(e) {
            $('#start_date').datetimepicker('maxDate', e.date);
        });
        $('#amount_modal').mask('000.000.000.000.000', {
            reverse: true
        });
        $('#days_modal').mask('00000', {
            reverse: true
        });
    });

    var activity_id_show = null
    var cc_request = null
    var country_id_show = null

    function showDataById(id_trip) {
        $.ajax({
            url: base_url_api + 'api/travel/showRequest/' + id_trip,
            type: "GET",
            beforeSend: function(xhr) {
                xhr.setRequestHeader('Authorization', 'Bearer ' + token_oauth);
            },
            success: function(result) {
                var data = result.data
                nextStep = true;
                $('#start_date_tgl').val(data.start_date)
                $('#end_date_tgl').val(data.end_date)
                $('#address').val(data.address)
                getActivity(data.schema_id)
                getExpenseType(data.schema_id)
                id_schema = data.schema_id
                cc_request = data.cc_request
                ccDefault = data.cc_default
                activity_id_show = data.activity_id
                useWbs = data.is_wbs
                country_id_show = data.country
                country = data.country_name
                total_exp_default = data.total_expense_request
                $('#reason').val(data.deskripsi_reason)
                $('#rincian_aktivitas').val(data.deskripsi_planning)
                $('#pejabat_dihubungi').val(data.contact_supperior_person)
                var file = data.file_url
                if (file.length > 0) {
                    file.forEach(x => {
                        file_attach.push(x)
                    })
                }
                initDropzone()
                var list_approver = $('#list_approver')
                list_approver.html('')
                var array = data.approver
                arr_approver = [];
                if (array != null) {
                    array.forEach((x, i) => {
                        var objApprover = {
                            "nik": x.nik,
                            "status": x.type_approver
                        }
                        arr_approver.push(objApprover)
                        var aprover = `<span class="label label-light-info label-inline font-weight-bolder font-size-sm label-sm">${x.type_approver}</span>`
                        if (i == 1) {
                            aprover = `<span class="label label-light-warning label-inline font-weight-bolder font-size-sm label-sm"  style="background-color:#E2FFD9; color:#67A653">${x.type_approver}</span>`
                        } else if (i == 2) {
                            aprover = `<span class="label label-light-danger label-inline font-weight-bolder font-size-sm label-sm" style="background-color:#FFE9D4; color:#DF9651">${x.type_approver}</span>`
                        }
                        var html = `<div class="d-flex align-items-center mb-5 mr-3">
                                                            <!--begin::Symbol-->
                                                            <div class="symbol symbol-50 mr-5">
                                                                <img src="${x.photo}" class="h-85 align-self-center" alt="approver">
                                                            </div>
                                                            <!--end::Symbol-->
                                                            <!--begin::Text-->
                                                            <div class="d-flex flex-column font-weight-bold">
                                                                <span class="text-dark text-hover-primary font-size-sm mb-1">${x.nik} - ${x.name}</span>
                                                                <span class="text-dark text-hover-primary font-size-sm mb-1">${x.potition}</span>
                                                                ${aprover}
                                                            </div>
                                                            <!--end::Text-->
                                                        </div>`
                        list_approver.append(html)
                    })
                }
                getCountry(country_id_show)
                getSchema(data.schema_id, data.nik)
                if (data.is_wbs == 0) {
                    $('.switch_button').show()
                    getCostCenter(data.schema_id, false)
                } else if(data.is_wbs == 1) {
                    $('.switch_button').show()
                    getWbs(data.schema_id);
                } else if (data.is_wbs == 2) {
                    $('.switch_button').hide()
                    getInternalOrder(data.schema_id,company)
                }
                var detail = data.detail
                if (detail.length > 0) {
                    detail = sortListExpenseType(detail)
                    detail.forEach((x, i) => {
                        var total_price = x.nilai * x.days
                        var objExpType = {
                            "local_id": 'expLocal' + local_id,
                            "id": x.id_trans_req_dtl,
                            "expense_id": x.expense_id ?? null,
                            "expense_type": x.expense.code,
                            "expense_name": x.expense.code + ' - ' + x.expense.desc,
                            "lumpsum": x.lumpsum,
                            "plafon": x.plafon,
                            "currency": (x.currency).replace(/^\s+|\s+$/gm,''),
                            "formula": x.formula,
                            "nilai": x.nilai,
                            "days": x.days,
                            "keterangan": x.keterangan,
                            "editable": x.editable
                        }
                        data_advn_exp.push(objExpType)
                        renderAdvcExpDefault(objExpType);
                    });
                    $('.total_advance').html('')
                    var totalDetail = data.total_detail
                    totalDetail.forEach(x=>{
                        var html = `<tr>
                                                                    <td colspan='4'>Total ${x.currency}</td>
                                                                    <td>${formatRupiah((x.jumlah).toString())}</td>
                                                                    <td colspan="3"></td>
                                                                </tr>`
                        $('.total_advance').append(html)
                    })
                    var html = `<tr>
                                                                    <td colspan='4'>Estimasi Keselurahan</td>
                                                                    <td class="">${formatRupiah((data.total_expense_request).toString())}</td>
                                                                    <td colspan="3"></td>
                                                                </tr>
                                                                <tr class="amount_label">
                                                                        <td colspan='4'>Remaining Budget</td>
                                                                        <td class="remaining_budget">-</td>
                                                                        <td colspan="3"></td>
                                                                    </tr>`
                    $('.total_advance').append(html)
                }
                checkBudget(id_schema, cc_request)
            },
            error: function(data) {
                Swal.fire("Tidak Ditemukan", "Data requedst Tidak Ditemukan", "error");
                handleUnauthorized(data);
            }
        })
    }

    function changeDateTravel() {
        var startDate = new Date($('#start_date_tgl').val())
        var endDate = new Date($('#end_date_tgl').val())
        var diff = ((endDate - startDate) / (1000 * 3600 * 24)) + 1
        if (data_advn_exp.length > 0) {
            var arr = data_advn_exp
            data_advn_exp = [];
            $('#columnDataAdvn').html('');
            $('#columnDataAdvn_detail').html('');
            index_tabel=1
            arr.forEach(x => {
                var days = diff
                if (x.formula == 1) {
                    days = diff - 1
                } else if (x.formula == 0){
                    days = 1
                }
                var nilai = x.lumpsum * days
                var objExpType = {
                    "local_id": 'expLocal' + local_id,
                    "id": x.id,
                    "expense_id": x.expense_id ?? null,
                    "expense_type": x.expense_name,
                    "expense_name": x.expense_name,
                    "lumpsum": x.lumpsum,
                    "plafon": x.plafon,
                    "currency": x.currency,
                    "formula": x.formula,
                    "nilai": nilai,
                    "days": days,
                    "keterangan": x.keterangan,
                    "editable": x.editable
                }
                data_advn_exp.push(objExpType)
                renderAdvcExpDefault(objExpType)
            })
            konversiRupiah(data_advn_exp)
        }

    }

    function getSchema(schemaId = null, nik = null) {
        $.ajax({
            url: base_url_api + 'api/travel/getSchema?company=' + company + '&nik=' + nik,
            type: "GET",
            beforeSend: function(xhr) {
                xhr.setRequestHeader('Authorization', 'Bearer ' + token_oauth);
            },
            success: function(result) {
                var schema = $('#schema');
                schema.empty()
                schema.append('<option value=""></option>');
                var arr = result.data
                arr.forEach(x => {
                    if ((x.nama_schema).includes("Luar Negeri") == false && country == 'Indonesia') {
                        schema.append(`<option value="${x.id_schema}">${x.nama_schema}</option>`)
                    } else if ((x.nama_schema).includes("Luar Negeri") == true && country != 'Indonesia') {
                        schema.append(`<option value="${x.id_schema}">${x.nama_schema}</option>`)
                    }
                });
            },
            complete: function(data) {
                $('#schema').val(schemaId).trigger('change')
            },
            error: function(data) {
                Swal.fire("Tidak Ditemukan", "Data Schema Tidak Ditemukan", "error");
                handleUnauthorized(data);
            }
        })
    }

    function getActivity(idSchema) {
        $.ajax({
            url: base_url_api + 'api/travel/getSchemaActivity?id_schema=' + idSchema,
            type: "GET",
            beforeSend: function(xhr) {
                xhr.setRequestHeader('Authorization', 'Bearer ' + token_oauth);
            },
            success: function(result) {
                var activity = $('#activity');
                activity.empty()
                activity.append('<option value=""></option>');
                var arr = result.data
                arr.forEach(x => {
                    activity.append(`<option value="${x.activity_id}">${x.activity.nama_activity}</option>`)
                });

                if (activity_id_show != null) {
                    $('#activity').val(activity_id_show).trigger('change')
                    id_activity = activity_id_show
                    if (data_advn_exp.length == 0) {
                        getExpenseTypeDefault(id_activity, emp_no, id_schema);
                    }
                }
            },
            error: function(data) {
                Swal.fire("Tidak Ditemukan", "Data Activity Tidak Ditemukan", "error");
                handleUnauthorized(data);
            }
        })
    }

    $("#is_wbs").on('change', function() {
        if ($(this).is(':checked')) {
            getWbs($('#schema').val())
        } else {
            getCostCenter($('#schema').val(), false)
        }
    });

    function getWbs(idSchema) {
        $.ajax({
            url: base_url_api + 'api/travel/getWbs',
            type: "post",
            data: {
                schema_id: idSchema,
                nik: emp_no
            },
            async: false,
            beforeSend: function(xhr) {
                $('#cost_assigment').html('');
                KTApp.block('#kt_content_travel', {
                    overlayColor: '#000000',
                    state: 'danger',
                    message: 'Please wait...'
                });
                xhr.setRequestHeader('Authorization', 'Bearer ' + token_oauth);
            },
            success: function(result) {
                var cost_assigment = $('#cost_assigment');
                cost_assigment.html('');
                cost_assigment.append('<option value=""></option>');
                var arr = result.data
                $('#is_wbs').prop('checked', true);
                useWbs = 1;

                arr.forEach(x => {
                    cost_assigment.append(`<option value="${x.code}">${x.code} - ${x.owner}</option>`)
                    if (x.status == 'default') {
                        cost_assigment.val(x.code).trigger('change')
                        costCenter = x.code
                        ccDefault = x.code
                    }
                });
                if (cc_request != null) {
                    $('#cost_assigment').val(cc_request).trigger('change');
                } else {
                    checkBudget(idSchema, costCenter)
                }
                getApprover(costCenter)
                KTApp.unblock('#kt_content_travel');
            },
            error: function(data) {
                Swal.fire("Tidak Ditemukan", "Data Cost Center Tidak Ditemukan", "error");
                handleUnauthorized(data);
            }
        })
    }

    function getCostCenter(idSchema, def = true) {
        $.ajax({
            url: base_url_api + 'api/travel/getCostCenter',
            type: "post",
            data: {
                schema_id: idSchema,
                nik: emp_no
            },
            beforeSend: function(xhr) {
                KTApp.block('#kt_content_travel', {
                    overlayColor: '#000000',
                    state: 'danger',
                    message: 'Please wait...'
                });
                $('#cost_assigment').empty();
                xhr.setRequestHeader('Authorization', 'Bearer ' + token_oauth);
            },
            success: function(result) {
                var cost_assigment = $('#cost_assigment');
                cost_assigment.html('');
                cost_assigment.append('<option value=""></option>');
                var arr = result.data
                $('#is_wbs').prop('checked', false);
                var isWbs = false;
                useWbs = 0;

                arr.forEach(x => {
                    cost_assigment.append(`<option value="${x.code}">${x.code} - ${x.owner}</option>`)
                    if (x.status == 'default') {
                        cost_assigment.val(x.code).trigger('change')
                        costCenter = x.code
                        ccDefault = x.code
                    } else if (x.status == 'wbs') {
                        isWbs = true;
                        if (def != true) {
                            cost_assigment.val(x.code).trigger('change')
                            costCenter = cc_request
                            ccDefault = x.code
                        } else {
                            costCenter = x.code
                            ccDefault = x.code
                        }


                    }
                });

                if (isWbs == true && def == true) {
                    getWbs(idSchema);
                }

                if (cc_request != null) {
                    $('#cost_assigment').val(cc_request).trigger('change');
                    checkBudget(idSchema, cc_request)
                    // getApprover(cc_request)
                } else {
                    checkBudget(idSchema, costCenter)
                    // getApprover(costCenter)
                }
                KTApp.unblock('#kt_content_travel');
            },
            error: function(data) {
                Swal.fire("Tidak Ditemukan", "Data Cost Center Tidak Ditemukan", "error");
                handleUnauthorized(data);
            }
        })
    }

    function getInternalOrder(idSchema,company=null) {
        $.ajax({
            url: base_url_api + 'api/travel/getIO?company='+company,
            type: "get",
            beforeSend: function(xhr) {
                KTApp.block('#kt_content_travel', {
                    overlayColor: '#000000',
                    state: 'danger',
                    message: 'Please wait...'
                });
                // $('#cost_assigment').empty();
                xhr.setRequestHeader('Authorization', 'Bearer ' + token_oauth);
            },
            success: function(result) {
                var cost_assigment = $('#cost_assigment');
                cost_assigment.html('');
                cost_assigment.append('<option value=""></option>');
                var arr = result.data
                $('#is_wbs').prop('checked', false);
                useWbs = 2;
                arr.forEach(x=> {
                    cost_assigment.append(`<option value="${x.kode}">${x.kode} - ${x.keterangan}</option>`);
                })

                if (cc_request != null) {
                    $('#cost_assigment').val(cc_request).trigger('change');
                    checkBudget(idSchema, cc_request)
                    getApprover(cc_request)
                }
                KTApp.unblock('#kt_content_travel');
            },
            error: function(data) {
                Swal.fire("Tidak Ditemukan", "Data Cost Center Tidak Ditemukan", "error");
                handleUnauthorized(data);
            }
        })
    }

    function getExpenseType(id_schema) {
        start_date = $('#start_date_tgl').val()
        end_date = $('#end_date_tgl').val()
        $.ajax({
            url: `${base_url_api}api/travel/getSchemaExpense`,
            type: "post",
            data: {
                id_schema: id_schema,
                start_date: start_date,
                end_date: end_date,
                nik: emp_no,
                type: 'request'
            },
            beforeSend: function(xhr) {
                $('#exp_type').empty();
                xhr.setRequestHeader('Authorization', 'Bearer ' + token_oauth);
            },
            success: function(result) {
                var exp_type = $('#exp_type');
                exp_type.append('<option value=""></option>');
                arr_exp_type = result.data
                if (arr_exp_type != null) {
                    arr_exp_type.forEach(x => {
                        if (x.type != 'vendor' && x.expense_desc != 'Biaya Harian [LN]' && x.expense_desc != 'Biaya Harian [DN]' && x.expense_desc != 'Biaya Harian [Training-DN]'&& x.expense_desc != 'Biaya Harian [Training-LN]') { 
                            exp_type.append(`<option value="${x.expense_id}">${x.expense_type} - ${x.expense_desc}</option>`)
                        }
                    });
                }
            },
            error: function(data) {
                Swal.fire("Tidak Ditemukan", "Data expense type Tidak Ditemukan", "error");
                handleUnauthorized(data);
            }
        })
    }

    function getExpenseTypeDefault(idActivity, emp_no, id_schema) {
        start_date = $('#start_date_tgl').val()
        end_date = $('#end_date_tgl').val()
        $.ajax({
            url: base_url_api + 'api/travel/getExpenseDefault',
            type: "post",
            data: {
                schema_id: id_schema,
                nik: emp_no,
                activity_id: idActivity,
                start_date: start_date,
                end_date: end_date
            },
            beforeSend: function(xhr) {
                $('#exp_type_default').empty();
                xhr.setRequestHeader('Authorization', 'Bearer ' + token_oauth);
            },
            success: function(result) {
                data_advn_exp = []
                var arr = result.data
                $('#columnDataAdvn').html('');
                $('#columnDataAdvn_detail').html('');
                index_tabel = 1
                if (arr.length>0) {
                    arr = sortListExpenseType(arr)
                    arr.forEach(x => {
                        var total_price = x.lumpsum * x.days
                        var objExpType = {
                            "local_id": 'expLocal' + local_id,
                            "id": null,
                            "expense_id": x.expense_id ?? null,
                            "expense_type": x.expense_type,
                            "expense_name": x.expense_type + ' - ' + x.expense_desc,
                            "lumpsum": x.lumpsum,
                            "plafon": x.plafon,
                            "currency": (x.currency).replace(/^\s+|\s+$/gm,''),
                            "nilai": total_price,
                            "formula": x.formula,
                            "days": x.days,
                            "keterangan": '-',
                            "editable": x.editable
                        }
                        data_advn_exp.push(objExpType)
                        renderAdvcExpDefault(objExpType);
                    })
                    konversiRupiah(data_advn_exp)
                }
                // $('.remaining_budget').html(remaining_budget > 0 ? formatRupiah(remaining_budget.toString()) : '0')
            },
            error: function(data) {
                Swal.fire("Tidak Ditemukan", "Data Cost Center Tidak Ditemukan", "error");
                handleUnauthorized(data);
            }
        })
    }
    var data_advn_exp = [];
    var konversi = [];

    function renderAdvcExpDefault(data) {
        var btn = ``;
        var keterangan = (data.expense_name).split(" ");
        var textKeterangan = keterangan[2] + " " + keterangan[3]
        if (textKeterangan != 'Biaya Harian') {
            btn = `<button type="button" onclick="editAdvancesType('${data.local_id}')" class="btn btn-icon btn-sm btn-warning">
                                    <i class="flaticon2-edit"></i>
                                </button> <button type="button" onclick="deleteAdvancesType('${data.local_id}')" class="btn btn-icon btn-sm btn-danger">
                                    <i class="flaticon2-trash"></i>
                                </button>`
        }
        var html = `<tr>
                        <td>${index_tabel}</td>
                        <td>${data.expense_name}</td>
                        <td>${formatRupiah((data.lumpsum).toString())}</td>
                        <td>${data.days}</td>
                        <td>${formatRupiah((data.nilai).toString())}</td>
                        <td>${data.currency}</td>
                        <td>${data.keterangan != ''?data.keterangan:'-'}</td>
                        <td>${btn}</td>
                    </tr>`
        var html_detail = `<tr>
                        <td>${index_tabel}</td>
                        <td>${data.expense_name}</td>
                        <td>${formatRupiah((data.lumpsum).toString())}</td>
                        <td>${data.days}</td>
                        <td>${formatRupiah((data.nilai).toString())}</td>
                        <td>${data.currency}</td>
                        <td colspan="2">${data.keterangan != ''?data.keterangan:'-'}</td>
                    </tr>`
        $('#columnDataAdvn').append(html);
        $('#columnDataAdvn_detail').append(html_detail);
        // $('.remaining_budget').html(remaining_budget > 0 ? formatRupiah((remaining_budget).toString()) : '0')
        index_tabel++
        local_id++
    }

    function editAdvancesType(local_id) {
        var data = data_advn_exp.filter(function(el) {
            return el.local_id == local_id
        })
        var startDate = new Date($('#start_date_tgl').val())
        var endDate = new Date($('#end_date_tgl').val())
        var diff = ((endDate - startDate) / (1000 * 3600 * 24)) + 1
        formula = data[0]['formula'] ?? 0
        if (formula == 1) {
            diff -= formula
        }

        $("#amount_modal").attr("readonly", true);
        $("#days_modal").attr("readonly", true);
        $("#amount_modal").addClass("form-control-solid");
        $("#days_modal").addClass("form-control-solid");
        $("#days_modal").removeAttr("max");
        $("#amount_modal").removeAttr("max");
        $("#amount_modal").attr("data-plafon", data[0]['plafon']);
        $("#currency_modal").removeAttr("disabled");
        if (data[0]['editable'] == true || data[0]['editable'] == 'true') {
            $("#amount_modal").removeClass("form-control-solid");
            $("#days_modal").removeClass("form-control-solid");
            $("#days_modal").attr("max", diff);
            if (data[0]['plafon'] != '0' || data[0]['plafon'] != 0) {
                $("#amount_modal").attr("max", data[0]['plafon']);
            }
            plafon = data[0]['plafon']
            $("#amount_modal").attr("readonly", false);
            $("#days_modal").attr("readonly", false);
        }else if (country != 'Indonesia') {
            $('#currency_hidden').val((data[0]['currency']).replace(/^\s+|\s+$/gm,''))
            $('#currency_modal').val((data[0]['currency']).replace(/^\s+|\s+$/gm,'')).trigger('change')
            $("#currency_modal").attr("disabled", true);
        }
        exp_type_id = data[0]['expense_id'] ?? null
        exp_type_code = data[0]['expense_type'] ?? null
        exp_name = data[0]['expense_name'] ?? null
        $('#id_request').val(data[0]['id'])
        $('#local_id').val(data[0]['local_id'])
        $('#exp_type').val(data[0]['expense_id']).trigger('change')
        $('#amount_modal').val(data[0]['lumpsum'])
        $('#currency_modal').val((data[0]['currency']).replace(/^\s+|\s+$/gm,'')).trigger('change')
        if (country == 'Indonesia') {
            $('#currency_hidden').val((data[0]['currency']).replace(/^\s+|\s+$/gm,''))
            $('#currency_modal').val((data[0]['currency']).replace(/^\s+|\s+$/gm,'')).trigger('change')
            $("#currency_modal").attr("disabled", true);
        }
        $('#total_price_modal').val(data[0]['nilai'])
        $('#days_modal').val(data[0]['days'])
        $('#description_modal').val(data[0]['keterangan'])
        $('#editable').val(data[0]['editable'])
        $('#advancesModal').modal('show')
    }

    function addAdvancesType() {
        var localId = $('#local_id').val();
        var expense_id = $('#exp_type').val() ?? ''
        if (expense_id != '' && $('#amount_modal').val() != '' && $('#currency_hidden').val() != '' && $('#days_modal').val() != '') {
            index_tabel = 1
            if (localId != null) {
                data_advn_exp = data_advn_exp.filter(function(obj) {
                    return obj.local_id != localId;
                });
                $('#columnDataAdvn').html('');
                $('#columnDataAdvn_detail').html('');
                data_advn_exp = sortListExpenseType(data_advn_exp)
                data_advn_exp.forEach(x => {
                    renderAdvcExpDefault(x)
                })
                $('#local_id').val('');
                localId = null
            }
            index_tabel = 1
            var nilai_lumpsum = ($('#amount_modal').val()).replace('.', '')
            var objExpType = {
                "local_id": 'expLocal' + local_id,
                "id": $('#id_request').val() != '0' ? $('#id_request').val() : null,
                "expense_id": expense_id,
                "expense_type": exp_type_code,
                "expense_name": exp_name,
                "formula": formula,
                "lumpsum": nilai_lumpsum,
                "plafon": plafon,
                "currency": ($('#currency_hidden').val()).replace(/^\s+|\s+$/gm,''),
                "nilai": $('#total_price_modal').val(),
                "days": $('#days_modal').val(),
                "keterangan": $('#description_modal').val(),
                "editable": $('#editable').val()
            }
            data_advn_exp.push(objExpType)
            data_advn_exp = sortListExpenseType(data_advn_exp)
            $('#columnDataAdvn').html('');
            $('#columnDataAdvn_detail').html('');
            data_advn_exp.forEach(x => {
                renderAdvcExpDefault(x)
            })
            konversiRupiah(data_advn_exp)
            // $('.remaining_budget').html(remaining_budget > 0 ? formatRupiah(remaining_budget.toString()) : '0')
            exp_type_id = null
            exp_type_code = null

            $('#id_request').val('0')
            $('#local_id').val('')
            $('#exp_type').val('').trigger('change')
            $('#amount_modal').val('')
            $('#currency_modal').val('').trigger('change')
            $('#currency_hidden').val('')
            $('#total_price_modal').val('')
            $('#days_modal').val('')
            $('#description_modal').val('')
            $('#editable').val('')
            $('#advancesModal').modal('hide')
        } else {
            Swal.fire({
                text: "Sorry, all fields are required, please try again.",
                icon: "error",
                buttonsStyling: false,
                confirmButtonText: "Ok, got it!",
                customClass: {
                    confirmButton: "btn font-weight-bold btn-light"
                }
            })
        }
    }

    function resetModal() {
        exp_type_id = null
        exp_type_code = null
        $('#id_request').val('0')
        $('#local_id').val('')
        $('#exp_type').val(null).trigger('change')
        $('#amount_modal').val('')
        $('#currency_modal').val(null).trigger('change')
        $('#currency_hidden').val('')
        $('#total_price_modal').val('')
        $('#days_modal').val('')
        $('#description_modal').val('')
        $('#editable').val('')
    }


    function deleteAdvancesType(local_id) {
        Swal.fire({
            title: "Delete",
            text: "Are you sure delete this data?",
            icon: "question",
            showCancelButton: true,
            confirmButtonText: "Yes, delete it!"
        }).then(function(result) {
            if (result.value) {
                checkBudget(id_schema, cc_request ?? costCenter)
                data_advn_exp = data_advn_exp.filter(function(el) {
                    return el.local_id != local_id
                })
                $('#columnDataAdvn').html('');
                $('#columnDataAdvn_detail').html('');
                index_tabel = 1
                data_advn_exp = sortListExpenseType(data_advn_exp) 
                data_advn_exp.forEach((x, i)=> {
                    renderAdvcExpDefault(x)
                })
                if (data_advn_exp.length == 0) {
                    resetTable()
                } else {
                    konversiRupiah(data_advn_exp)
                }
                Swal.fire(
                    "Deleted!",
                    "Your file has been deleted.",
                    "success"
                )
            }
        });

    }

    function sortListExpenseType(listExpenseType) {
        return listExpenseType.sort((a, b) => {
                    let fa = a.currency.toLowerCase(),
                        fb = b.currency.toLowerCase();

                    if (fa < fb) {
                        return -1;
                    }
                    if (fa > fb) {
                        return 1;
                    }
                    return 0;
                })
    }

    function konversiRupiah(exp_type_list) {
        $.ajax({
            url: base_url_api + 'api/travel/konversiRupiah',
            type: "post",
            data: {
                expense: exp_type_list
            },
            beforeSend: function(xhr) {
                xhr.setRequestHeader('Authorization', 'Bearer ' + token_oauth);
            },
            success: function(result) {
                var arr = result.data
                var total = 0;
                total_exp_default = 0
                $('.total_advance').html('')
                if (result.status == 200) {
                    arr.forEach(x => {
                        var html = `<tr>
                                                                    <td colspan='4'>Total ${x.currency}</td>
                                                                    <td>${formatRupiah((x.jumlah).toString())}</td>
                                                                    <td colspan='3'></td>
                                                                </tr>`
                        $('.total_advance').append(html)
                        total += parseInt(x.nilai_konversi)
                    })
                    
                    var html = `<tr>
                                                                    <td colspan='4'>Estimasi Keselurahan</td>
                                                                    <td class="">${formatRupiah((total).toString())}</td>
                                                                    <td></td>
                                                                    <td colspan="2"></td>
                                                                </tr>
                                                                <tr class="amount_label">
                                                                        <td colspan='4'>Remaining Budget</td>
                                                                        <td class="remaining_budget">-</td>
                                                                        <td colspan='3'></td>
                                                                    </tr>`
                    $('.total_advance').append(html)
    
                    total_exp_default = total
                }

            },
            complete: function(data) {
                checkBudget(id_schema, cc_request ?? costCenter)
            },
            error: function(data) {
                console.log('Error check budget')
            }
        })
    }

    function getCountry(country = null) {
        $.ajax({
            url: base_url_api + 'api/travel/getCountry',
            type: "get",
            beforeSend: function(xhr) {
                xhr.setRequestHeader('Authorization', 'Bearer ' + token_oauth);
            },
            success: function(result) {
                var arr = result.data
                var country = $('#country')
                country.html('')
                country.append(`<option value=""></option>`)
                arr.forEach(x => {
                    country.append(`<option value="${x.code}">${x.nama}</option>`)
                })
            },
            complete: function(data) {
                $('#country').val(country).trigger('change')
                if (country == 'ID') {
                    $("#currency_modal").attr("disabled", true);
                } else {
                    $("#currency_modal").removeAttr("disabled");
                }
                if (id_schema != null) {
                    getSchema(id_schema, emp_no)
                }
            },
            error: function(data) {
                console.log('Error check budget')
            }
        })
    }

    var budget = 0;
    var alert_budget = null
    var icon_submit = "question"

    function checkBudget(id_schema, costCenter) {
        var fundCenter = $('.fund_center');
        var fundDesc = $('.fund_desc');
        var commitItem = $('.commit_item');
        var desc = $('.desc_budget');
        var amount_budget = $('.amount_budget');
        $.ajax({
            url: base_url_api + 'api/travel/checkAnggaran',
            type: "post",
            data: {
                schema_id: id_schema,
                costcenter: costCenter,
                is_wbs: useWbs
            },
            beforeSend: function(xhr) {
                fundCenter.html('-')
                fundDesc.html('-')
                commitItem.html('-')
                desc.html('-')
                amount_budget.html('-')
                xhr.setRequestHeader('Authorization', 'Bearer ' + token_oauth);
            },
            success: function(result) {
                fundCenter.html((result.data.costcenter) ? result.data.costcenter + ' - ' + result.data.costcenter_desc : '-')
                fundDesc.html((result.data.costcenter_desc) ?? '-')
                commitItem.html((result.data.account) ?? '-')
                desc.html(result.data.account_desc ?? '-')
                amount_budget.html((result.data.anggaran ?? 0) > 0 ? formatRupiah((result.data.anggaran).toString()) + ' ' + result.data.currency : '0')
                remaining_budget = result.data.anggaran
                showWarning(remaining_budget)
                remaining_budget -= total_exp_default
                $('.remaining_budget').html(remaining_budget > 0 ? formatRupiah(remaining_budget.toString()) : '0')
                if (ccDefault != costCenter) {
                    amount_budget.hide()
                    $('.amount_label').hide()
                    $('.remaining_budget').html('')
                } else {
                    $('.amount_label').show()
                    amount_budget.show()
                }
            },
            error: function(data) {
                console.log('Error check budget')
            }
        })
    }

    function showWarning(remaining) {
        if (remaining < 10000000) {
            $('#alert_anggaran').show();
            alert_budget = '<span style="color:red!important;">Sisa anggaran kurang dari 10 Juta Rupiah<span>'
            icon_submit = 'warning'
        } else {
            $('#alert_anggaran').hide();
            icon_submit = "question"
            alert_budget = null
        }
    }

    $('#schema').on('select2:select', function(e) {
        id_schema = e.params.data.id
        id_activity = null
        activity_id_show = null
        getActivity(id_schema)
        if (e.params.data.text== 'Docking') {
            $('.switch_button').hide()
            getInternalOrder(id_schema,company);
        }else{
            $('.switch_button').show()
            getCostCenter(id_schema)
        }
        getExpenseType(id_schema)
    });
    $('#activity').on('select2:select', function(e) {
        id_activity = e.params.data.id
        getExpenseTypeDefault(id_activity, emp_no, id_schema);
    });
    var country = null
    $('#country').on('select2:select', function(e) {
        country = e.params.data.text
        getSchema(null, emp_no)
        if (country == 'Indonesia') {
            $("#currency_modal").attr("disabled", true);
        } else {
            $("#currency_modal").removeAttr("disabled");
        }
    });

    $('#cost_assigment').on('select2:select', function(e) {
        costCenter = e.params.data.id
        checkBudget(id_schema, costCenter)
        getApprover(costCenter);

    });

    function maxDays() {
        var startDate = new Date($('#start_date_tgl').val())
        var endDate = new Date($('#end_date_tgl').val())
        var diff = ((endDate - startDate) / (1000 * 3600 * 24)) + 1
        var formula = $('#days_modal').attr("data-formula")
        if (formula == 1) {
            diff -= formula
        }

        if ($("#days_modal").val() > diff) {
            $("#days_modal").val(diff)
            sumDetailExpenseType();
        }
    }

    function maxPlafon(val) {
        var plafon = $('#amount_modal').attr("data-plafon")
        if (plafon != 0) {
            if (parseInt(val.value) > parseInt(val.max)) {
                Swal.fire("Gagal", "Nilai Melebihi total plafon", "error");
                $("#amount_modal").val(val.max)
            }
        } else {
            $("#amount_modal").val(val.value)
        }
        sumDetailExpenseType();
    }
    var exp_type_code = null
    var exp_type_id = null
    var plafon = null
    var exp_type = ''
    var exp_name = ''
    var formula = 0
    $('#exp_type').on('select2:select', function(e) {
        $('#currency_modal').val('').trigger('change');
        $('#currency_hidden').val('')
        exp_type = e.params.data
        exp_name = exp_type.text
        var chooseExpType = arr_exp_type.filter(function(el) {
            return el.expense_id == exp_type.id
        });
        $("#amount_modal").attr("readonly", false);
        $("#days_modal").attr("readonly", false);
        $("#days_modal").removeAttr("max");
        $("#amount_modal").removeAttr("max")
        var startDate = new Date($('#start_date_tgl').val())
        var endDate = new Date($('#end_date_tgl').val())
        var diff = ((endDate - startDate) / (1000 * 3600 * 24)) + 1
        formula = chooseExpType[0]['formula'] ?? 0
        if (formula == 1) {
            diff -= formula
        }

        if (diff < 0) {
            diff = 0
        }
        $("#days_modal").attr("max", diff);
        $("#amount_modal").removeClass("form-control-solid");
        $("#days_modal").removeClass("form-control-solid");
        $('#editable').val(chooseExpType[0]['editable']);
        $("#days_modal").attr("data-formula", formula);
        $("#amount_modal").attr("data-plafon", chooseExpType[0]['plafon']);
        $("#currency_modal").removeAttr("disabled");
        if (chooseExpType[0]['editable'] == false) {
            $("#amount_modal").attr("readonly", true);
            $("#days_modal").attr("readonly", true);
            $("#amount_modal").addClass("form-control-solid");
            $("#days_modal").addClass("form-control-solid");
            if (country != 'Indonesia') {
                    $('#currency_modal').val((chooseExpType[0]['currency']).replace(/^\s+|\s+$/gm,'')).trigger('change');
                    $('#currency_hidden').val((chooseExpType[0]['currency']).replace(/^\s+|\s+$/gm,''))
                    $("#currency_modal").attr("disabled", true);
            }
        } else if (chooseExpType[0]['plafon'] != 0 || chooseExpType[0]['plafon'] != '0') {
            $("#amount_modal").attr("max", chooseExpType[0]['plafon']);
        }


        if ((chooseExpType[0]['currency']).replace(/^\s+|\s+$/gm,'') != null) {
            $('#currency_modal').val((chooseExpType[0]['currency']).replace(/^\s+|\s+$/gm,'')).trigger('change');
            $('#currency_hidden').val((chooseExpType[0]['currency']).replace(/^\s+|\s+$/gm,''))
            if (country == 'Indonesia') {
                $('#currency_modal').val((chooseExpType[0]['currency']).replace(/^\s+|\s+$/gm,'')).trigger('change');
                $('#currency_hidden').val((chooseExpType[0]['currency']).replace(/^\s+|\s+$/gm,''))
                $("#currency_modal").attr("disabled", true);
            }
        }
        exp_type_code = chooseExpType[0]['expense_type'] ?? null
        plafon = chooseExpType[0]['plafon'] ?? null
        var lumpsum = chooseExpType[0]['lumpsum'] ?? null
        var days = chooseExpType[0]['days'] ?? 0
        var total_price_modal = lumpsum * days
        $('#amount_modal').val(lumpsum)
        $('#days_modal').val(days)
        $('#total_price_modal').val(total_price_modal)

    });

    function sumDetailExpenseType() {
        var nilai = ($('#amount_modal').val()).replaceAll('.', '') ?? '0'
        var days = $('#days_modal').val() ?? '0'
        var total = parseFloat(nilai) * parseFloat(days)
        $('#total_price_modal').val(total)
    }

    function getApprover(costCenter = null) {
        $.ajax({
            url: base_url_api + 'api/travel/getApprover?nik=' + emp_no + '&costcenter=' + costCenter,
            type: "get",
            beforeSend: function(xhr) {
                xhr.setRequestHeader('Authorization', 'Bearer ' + token_oauth);
            },
            success: function(result) {
                if (result.status == 200) {
                    var list_approver = $('#list_approver')
                    list_approver.html('')
                    var array = result.data
                    arr_approver = [];
                    array.forEach((x, i) => {
                        var objApprover = {
                            "nik": x.empData.emp_no,
                            "status": x.status
                        }
                        arr_approver.push(objApprover)
                        var aprover = `<span class="label label-light-info label-inline font-weight-bolder font-size-sm label-sm">${x.status}</span>`
                        if (i == 1) {
                            aprover = `<span class="label label-light-warning label-inline font-weight-bolder font-size-sm label-sm"  style="background-color:#E2FFD9; color:#67A653">${x.status}</span>`
                        } else if (i == 2) {
                            aprover = `<span class="label label-light-danger label-inline font-weight-bolder font-size-sm label-sm" style="background-color:#FFE9D4; color:#DF9651">${x.status}</span>`
                        }
                        var html = `<div class="d-flex align-items-center mb-5 mr-3">
                                                        <!--begin::Symbol-->
                                                        <div class="symbol symbol-50 mr-5">
                                                            <img src="${x.photo}" class="h-85 align-self-center" alt="approver">
                                                        </div>
                                                        <!--end::Symbol-->
                                                        <!--begin::Text-->
                                                        <div class="d-flex flex-column font-weight-bold">
                                                            <span class="text-dark text-hover-primary font-size-sm mb-1">${x.empData.emp_no} - ${x.empData.nama}</span>
                                                            <span class="text-dark text-hover-primary font-size-sm mb-1">${x.empData.pos_title}</span>
                                                            ${aprover}
                                                        </div>
                                                        <!--end::Text-->
                                                    </div>`
                        list_approver.append(html)
                    })
                } else {
                    Swal.fire({
                        text: result.ResponseString,
                        icon: "error",
                        buttonsStyling: false,
                        confirmButtonText: "Ok, got it!",
                        customClass: {
                            confirmButton: "btn font-weight-bold btn-primary",
                        }
                    });
                }
            },
            error: function(data) {
                console.log('Error check budget')
            }
        })
    }

    // function showTable() {
    //     if (data_advn_exp.length == 0) {
    //         getExpenseTypeDefault(id_activity, emp_no, id_schema);
    //     }
    //     $('#btn_advance').show();
    //     $('#btn_del_advance').show();
    //     $('#btn_show_advnc').hide();
    //     $('.advance_exp_type').show();
    // }

    function resetTable() {
        // $('#btn_advance').hide();
        // $('#btn_del_advance').hide();
        // $('#btn_show_advnc').show();
        // $('.advance_exp_type').hide();
        $('#columnDataAdvn').html('');
        $('#columnDataAdvn_detail').html('');
        data_advn_exp = [];
        total_exp_default = 0;
        remaining_budget = 0;
        index_tabel = 1;
    }

    function updateDetail() {
        $('#start_date_detail').text($('#start_date_tgl').val() + ' - ' + $('#end_date_tgl').val())
        $('#address_detail').text($('#address').val())
        $('#country_detail').text($('#country').find(':selected').text())
        $('#schema_detail').text($('#schema').find(':selected').text())
        $('#activity_detail').text($('#activity').find(':selected').text())
        $('#reason_detail').text($('#reason').val())
        $('#rincian_detail').text($('#rincian_aktivitas').val())
        $('#pejabat_dihubungi_detail').text($('#pejabat_dihubungi').val())
        $('#cost_assign_detail').text($('#cost_assigment').find(':selected').text())
        $('#badge-wbs').hide();
        if (useWbs == 1) {
            $('#badge-wbs').show();
        }
    }

    var nextStep = false;

    function checkDateTrip() {
        var obj = {
            "nik": emp_no,
            "start_date": $('#start_date_tgl').val(),
            "end_date": $('#end_date_tgl').val()
        }

        $.ajax({
            url: base_url_api + 'api/travel/checkDateTrip',
            type: "post",
            data: obj,
            async: false,
            beforeSend: function(xhr) {
                xhr.setRequestHeader('Authorization', 'Bearer ' + token_oauth);
            },
            success: function(result) {
                if (result.status == 200) {
                    nextStep = true;
                } else {
                    Swal.fire({
                        text: result.ResponseString,
                        icon: "error",
                        buttonsStyling: false,
                        confirmButtonText: "Ok, got it!",
                        customClass: {
                            confirmButton: "btn font-weight-bold btn-primary",
                        }
                    });
                    wizard.goTo(1);
                }
            },
            error: function(data) {
                console.log('Error check date tripe')
            }
        })
    }

    function storeRequest(status) {
        $.ajax({
            url: base_url_api + 'api/travel/getApprover?nik=' + emp_no + '&costcenter=' + $('#cost_assigment').val(),
            type: "get",
            beforeSend: function(xhr) {
                KTApp.blockPage({
                    zIndex: 20000,
                    overlayColor: '#000000',
                    state: 'danger',
                    message: 'Mohon Menunggu, Sedang Proses Menyimpan Data...'
                });
                xhr.setRequestHeader('Authorization', 'Bearer ' + token_oauth);
            },
            success: function(result) {
                KTApp.unblockPage();
                var list_approver = $('#list_approver')
                list_approver.html('')
                var array = result.data
                arr_approver = [];
                array.forEach((x, i) => {
                    var objApprover = {
                        "nik": x.empData.emp_no,
                        "status": `Approver ${i+1}`
                    }
                    arr_approver.push(objApprover)
                })
            },
            complete: function(data) {
                KTApp.unblockPage();
                storeAction(status)
            },
            error: function(data) {
                KTApp.unblockPage();
                console.log('Error check budget')
            }
        })
    }

    function storeAction(status) {
        if (useWbs == 2) {
            ccDefault = $('#cost_assigment').val()
        }
        var obj = {
            "id_trip": $('#id_trip').val() != '0' ? $('#id_trip').val() : null,
            "nik": emp_no,
            "schema_id": $('#schema').val(),
            "activity_id": $('#activity').val(),
            "cc_default": ccDefault,
            "cc_request": $('#cost_assigment').val(),
            "start_date": $('#start_date_tgl').val(),
            "end_date": $('#end_date_tgl').val(),
            "deskripsi_planning": $('#rincian_aktivitas').val(),
            "deskripsi_reason": $('#reason').val(),
            "country": $('#country').val(),
            "address": $('#address').val(),
            "status": status,
            "approver": arr_approver,
            "contact_supperior_person": $('#pejabat_dihubungi').val(),
            "detail": data_advn_exp,
            "file_url": file_attach,
            "is_wbs": useWbs,
            "is_admin": is_admin,
            "total_estimation": total_exp_default
        }
        $.ajax({
            url: base_url_api + 'api/travel/storeRequest',
            type: "post",
            data: obj,
            beforeSend: function(xhr) {
                KTApp.blockPage({
                    zIndex: 20000,
                    overlayColor: '#000000',
                    state: 'danger',
                    message: 'Mohon Menunggu, Sedang Proses Menyimpan Data...'
                });
                xhr.setRequestHeader('Authorization', 'Bearer ' + token_oauth);
            },
            success: function(res) {
                if (res.status == 200) {
                    if (is_admin == 0) {
                        window.location.href = `https://pismart.pupuk-indonesia.com/travel_management/travel_request`
                    } else {
                        window.location.href = `https://pismart.pupuk-indonesia.com/travel_management/admin/monitoring`
                    }
                } else {
                    Swal.fire({
                        text: res.ResponseString,
                        icon: "error",
                        buttonsStyling: false,
                        confirmButtonText: "Ok, got it!",
                        customClass: {
                            confirmButton: "btn font-weight-bold btn-primary",
                        }
                    }).then(function(result) {
                        if (res.ResponseString == 'Gagal Lock Anggaran') {
                            if (result.value || result.dismiss) {
                                window.location.href = `https://pismart.pupuk-indonesia.com/travel_management/travel_request`
                            }
                        }
                    });
                }
                KTApp.unblockPage();
            },
            error: function(data) {
                KTApp.unblockPage();
                console.log('Error check budget')
            }
        })
    }

    function hideDraft() {
        $('#btn_draft').hide();
    }

    function initDropzone() {
        $('#customFile').dropzone({
            url: `https://pismart.pupuk-indonesia.com/travel_management/store_file`,
            autoProcessQueue: true,
            uploadMultiple: true,
            parallelUploads: 5,
            addRemoveLinks: true,
            maxFiles: 15,
            maxFilesize: 2,
            headers: {
                'X-CSRF-TOKEN': $('meta[name="csrf-token"]').attr('content')
            },
            init: function() {
                dzClosure = this;
                file_attach.forEach(x => {
                    var mockFile = {
                        name: x.original_name,
                        size: x.size
                    }
                    var img = "https://pismart.pupuk-indonesia.com/public/assets/media/icon-menu/icon_file_travel.png"
                    if (x.extension == "jpg" || x.extension == "gif" || x.extension == "jpeg" || x.extension == "png" || x.extension == "svg") {
                        img = x.url
                    }
                    dzClosure.options.addedfile.call(this, mockFile);
                    dzClosure.options.thumbnail.call(this, mockFile, img);
                    dzClosure.processQueue();
                })
                $(".dz-progress").remove();
                dzClosure.on('addedfile', function(file) {

                    var ext = file.name.split('.').pop();

                    if (ext != "jpg" || ext != "gif" || ext != "jpeg" || ext != "png" || ext != "svg") {
                        $(file.previewElement).find(".dz-image img").attr("src", "https://pismart.pupuk-indonesia.com/public/assets/media/icon-menu/icon_file_travel.png");
                    }
                });
                dzClosure.on("sendingmultiple", function(data, xhr, formData) {
                    formData.append('type', 'request');
                })
                dzClosure.on("successmultiple", function(files, response) {
                    var arr = response.data
                    arr.forEach(x => {
                        file_attach.push(x)
                    })
                });
                dzClosure.on("removedfile", function(file) {
                    file_attach = file_attach.filter(function(obj) {
                        return obj.original_name != file.name;
                    });
                });
                dzClosure.on("errormultiple", function(files, response) {
                    if (this.getQueuedFiles().length == 0 && this.getUploadingFiles().length == 0) {
                        var _this = this;
                        // Remove all files
                        // _this.removeAllFiles();
                    }
                    // location.reload();
                });
            }
        })
    }

    $(".nik_karyawan").select2({
        placeholder: "Masukkan Nama atau Nomor Pegawai",
        allowClear: true,
        ajax: {
            url: "https://pismart.pupuk-indonesia.com/performance/pic_performance/manage/karyawan_search",
            dataType: 'json',
            delay: 250,
            data: function(params) {
                return {
                    q: params.term, // search term
                    company_code: com_code_user,
                    page: params.page
                };
            },
            processResults: function(data, params) {
                params.page = params.page || 1;

                data.forEach(function(entry, index) {
                    entry.id = entry.emp_no
                })

                return {
                    results: data,
                    pagination: {
                        more: (params.page * 30) < data.length
                    }
                };
            },
            cache: true
        },
        escapeMarkup: function(markup) {
            return markup;
        }, // let our custom formatter work
        minimumInputLength: 4,
        templateResult: formatRepo1, // omitted for brevity, see the source of this page
        templateSelection: formatRepoSelection1 // omitted for brevity, see the source of this page
    });

    function changeCurrency() {
        var value = $('#currency_modal').val();
        $('#currency_hidden').val(value)
    }

    function formatRepo1(repo1) {
        if (repo1.loading) return repo1.text;

        var markup = `
                    <div class="d-flex align-items-center">
                    <div class="symbol symbol-40 symbol-light-success flex-shrink-0">
                        <img class="" src="${repo1.cur_photo}" onerror="imgError(this);" alt="photo">
                    </div>
                    <div class="ml-4">
                    <div class="text-dark-75 font-weight-bolder font-size-lg mb-0">${repo1.nama} - ${repo1.emp_no} | ${repo1.pos_title} - ${repo1.pos_id}</div>
                    <a href="#" class="text-muted font-weight-bold text-hover-primary">${repo1.m_company.name}</a>
                    </div>
                </div>`;

        return markup;
    }

    function formatRepoSelection1(repo1) {
        if (repo1.text == '') {
            return repo1.nama + ' - ' + repo1.emp_no + ' | ' + repo1.pos_title + ' - ' + repo1.pos_id + ' | ' + repo1.m_company.name;
        } else {
            return repo1.text;
        }
    }

    $('.nik_karyawan').on('select2:select', function(e) {
        var data = e.params.data;
        company = data.company
        $('#nik').val(data.emp_no);
        $("#company").val(data.company)
        emp_no = data.emp_no
        getApprover()
    });
</script>
<script>
    "use strict";

    // Class definition
    var KTWizard4 = function() {
        // Base elements
        var _wizardEl;
        var _formEl;
        var _wizardObj;
        var _validations = [];

        // Private functions
        var _initWizard = function() {
            // Initialize form wizard
            _wizardObj = new KTWizard(_wizardEl, {
                startStep: 1, // initial active step number
                clickableSteps: true // allow step clicking
            });

            // Validation before going to next page
            _wizardObj.on('change', function(wizard) {
                if (id_schema != null && wizard.getStep() == 2 && data_advn_exp.length == 0) {
                    getExpenseTypeDefault(id_activity, emp_no, id_schema)
                }
                if (wizard.getStep() > wizard.getNewStep()) {
                    $('#btn_draft').hide();
                    return; // Skip if stepped back
                }
                updateDetail()

                if (wizard.getNewStep() == 4) {
                    $('#btn_draft').show();
                }

                // Validate form before change wizard step
                var validator = _validations[wizard.getStep() - 1];
                if (wizard.getStep() == 1 && id_trip == 0) {
                    checkDateTrip();
                }

                if (wizard.getStep() > 1) {
                    showWarning(remaining_budget)
                }

                // get validator for currnt step

                if (validator && nextStep == true) {
                    validator.validate().then(function(status) {
                        if (status == 'Valid') {
                            wizard.goTo(wizard.getNewStep());

                            KTUtil.scrollTop();
                        } else {
                            // Swal.fire({
                            //     text: "Sorry, looks like there are some errors detected, please try again.",
                            //     icon: "error",
                            //     buttonsStyling: false,
                            //     confirmButtonText: "Ok, got it!",
                            //     customClass: {
                            //         confirmButton: "btn font-weight-bold btn-light"
                            //     }
                            // }).then(function() {
                            //     KTUtil.scrollTop();
                            // });
                            KTUtil.scrollTop();
                        }
                    });
                }

                return false; // Do not change wizard step, further action will be handled by he validator
            });

            // Change event
            _wizardObj.on('changed', function(wizard) {
                KTUtil.scrollTop();
            });

            // Submit event
            _wizardObj.on('submit', function(wizard) {
                Swal.fire({
                    html: alert_budget,
                    title: "Apakah anda yakin submit form ini?",
                    icon: icon_submit,
                    showCancelButton: true,
                    buttonsStyling: false,
                    confirmButtonText: "Yes, submit!",
                    cancelButtonText: "No, cancel",
                    customClass: {
                        confirmButton: "btn font-weight-bold btn-primary",
                        cancelButton: "btn font-weight-bold btn-default"
                    }
                }).then(function(result) {
                    if (result.value) {
                        storeAction('Record')
                    }
                });
            });
        }

        var _initValidation = function() {
            // Init form validation rules. For more info check the FormValidation plugin's official documentation:https://formvalidation.io/
            // Step 1
            _validations.push(FormValidation.formValidation(
                _formEl, {
                    fields: {
                        start_date: {
                            validators: {
                                notEmpty: {
                                    message: 'Start date is required'
                                }
                            }
                        },
                        end_date: {
                            validators: {
                                notEmpty: {
                                    message: 'End date is required'
                                }
                            }
                        },
                        address: {
                            validators: {
                                notEmpty: {
                                    message: 'Address is required'
                                }
                            }
                        },
                        country: {
                            validators: {
                                notEmpty: {
                                    message: 'Country is required'
                                }
                            }
                        },
                    },
                    plugins: {
                        trigger: new FormValidation.plugins.Trigger(),
                        // Bootstrap Framework Integration
                        bootstrap: new FormValidation.plugins.Bootstrap({
                            //eleInvalidClass: '',
                            eleValidClass: '',
                        })
                    }
                }
            ));

            // Step 2
            _validations.push(FormValidation.formValidation(
                _formEl, {
                    fields: {
                        schema: {
                            validators: {
                                notEmpty: {
                                    message: 'Schema is required'
                                }
                            }
                        },
                        activity: {
                            validators: {
                                notEmpty: {
                                    message: 'Activity is required'
                                }
                            }
                        },
                        reason: {
                            validators: {
                                notEmpty: {
                                    message: 'Reason is required'
                                }
                            }
                        },
                        rincian_aktivitas: {
                            validators: {
                                notEmpty: {
                                    message: 'Activity planning detail is required'
                                }
                            }
                        },
                        pejabat_dihubungi: {
                            validators: {
                                notEmpty: {
                                    message: 'Contact superior person is required'
                                }
                            }
                        },
                    },
                    plugins: {
                        trigger: new FormValidation.plugins.Trigger(),
                        // Bootstrap Framework Integration
                        bootstrap: new FormValidation.plugins.Bootstrap({
                            //eleInvalidClass: '',
                            eleValidClass: '',
                        })
                    }
                }
            ));

            // Step 3
            _validations.push(FormValidation.formValidation(
                _formEl, {
                    fields: {
                        cost_assigment: {
                            validators: {
                                notEmpty: {
                                    message: 'Cost Assignment is required'
                                }
                            }
                        },
                    },
                    plugins: {
                        trigger: new FormValidation.plugins.Trigger(),
                        // Bootstrap Framework Integration
                        bootstrap: new FormValidation.plugins.Bootstrap({
                            //eleInvalidClass: '',
                            eleValidClass: '',
                        })
                    }
                }
            ));
        }

        return {
            // public functions
            init: function() {
                _wizardEl = KTUtil.getById('kt_wizard');
                _formEl = KTUtil.getById('kt_form');

                _initWizard();
                _initValidation();
            }
        };
    }();

    jQuery(document).ready(function() {
        KTWizard4.init();
    });
</script>

</body>

</html>